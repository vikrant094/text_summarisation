(function(g){var window=this;'use strict';var i7B=function(q){var a=new g.mf("und",new g.M5("Default","und",!0));a.captionTracks=q.captionTracks;return a},Wcy=function(q){return new g.LT(function(a,w){var G=q.length,k=[];
if(G)for(var b=function(Y,P){G--;k[Y]=P;G==0&&a(k)},O=function(Y){w(Y)},e,N=0;N<q.length;N++)e=q[N],g.o$y(e,g.Yc(b,N),O);
else a(k)})},Hu=function(q){this.V=q},cu=function(){Hu.apply(this,arguments)},DEV=function(){cu.apply(this,arguments)},RGK=function(){cu.apply(this,arguments)},ypJ=function(){cu.apply(this,arguments)},qhU=function(){cu.apply(this,arguments)},gF7=function(){cu.apply(this,arguments)},a36=function(){cu.apply(this,arguments)},w2c=function(){cu.apply(this,arguments)},Gyw=function(){Hu.apply(this,arguments)},kyK=function(){cu.apply(this,arguments)},bVe=function(){cu.apply(this,arguments)},OVV=function(){cu.apply(this,
arguments)},l3c=function(){cu.apply(this,arguments)},edU=function(){cu.apply(this,arguments)},N9B=function(){cu.apply(this,arguments)},Yhe=function(){cu.apply(this,arguments)},PLy=function(){cu.apply(this,arguments)},KLR=function(){cu.apply(this,arguments)},doJ=function(){cu.apply(this,arguments)},T96=function(){cu.apply(this,arguments)},$ow=function(){cu.apply(this,arguments)},suB=function(){Hu.apply(this,arguments)},FLK=function(){cu.apply(this,arguments)},CLe=function(){cu.apply(this,arguments)},
ZVl=function(){cu.apply(this,arguments)},EFJ=function(){cu.apply(this,arguments)},VzU=function(){cu.apply(this,arguments)},J1R=function(){cu.apply(this,arguments)},moB=function(){cu.apply(this,arguments)},Qux=function(){cu.apply(this,arguments)},A17=function(){cu.apply(this,arguments)},xoU=function(){Hu.apply(this,arguments)},LLc=function(){Hu.apply(this,arguments)},B9J=function(){Hu.apply(this,arguments)},r1y=function(){cu.apply(this,arguments)},nFU=function(){cu.apply(this,arguments)},Mzl=function(){cu.apply(this,
arguments)},hd7=function(){cu.apply(this,arguments)},ShK=function(){cu.apply(this,arguments)},f36=function(){cu.apply(this,arguments)},HVV=function(){cu.apply(this,arguments)},c1B=function(){cu.apply(this,arguments)},p2x=function(){cu.apply(this,arguments)},Uoe=function(){cu.apply(this,arguments)},X2y=function(){cu.apply(this,arguments)},juU=function(){cu.apply(this,arguments)},oFR=function(){cu.apply(this,arguments)},I3y=function(){cu.apply(this,arguments)},uk8=function(){cu.apply(this,arguments)},
tzw=function(){cu.apply(this,arguments)},vFI=function(){cu.apply(this,arguments)},zdK=function(){cu.apply(this,arguments)},iVc=function(){cu.apply(this,arguments)},WLy=function(){cu.apply(this,arguments)},Doc=function(){cu.apply(this,arguments)},RdJ=function(){cu.apply(this,arguments)},y18=function(){cu.apply(this,arguments)},qqR=function(){cu.apply(this,arguments)},gE6=function(){cu.apply(this,arguments)},aG7=function(){cu.apply(this,arguments)},wOR=function(){cu.apply(this,arguments)},G_y=function(){Hu.apply(this,
arguments)},k_l=function(){cu.apply(this,arguments)},bT6=function(){cu.apply(this,arguments)},OTJ=function(){cu.apply(this,arguments)},lG6=function(){cu.apply(this,arguments)},eEe=function(){cu.apply(this,arguments)},NHB=function(){cu.apply(this,arguments)},Yqx=function(){cu.apply(this,arguments)},PyB=function(){cu.apply(this,arguments)},K$x=function(){cu.apply(this,arguments)},dIV=function(){cu.apply(this,arguments)},TH7=function(){cu.apply(this,arguments)},$II=function(){cu.apply(this,arguments)},
slc=function(){cu.apply(this,arguments)},F$V=function(){cu.apply(this,arguments)},CyR=function(){cu.apply(this,arguments)},ZTK=function(){cu.apply(this,arguments)},EER=function(){cu.apply(this,arguments)},VYV=function(){cu.apply(this,arguments)},Jtx=function(){cu.apply(this,arguments)},mIJ=function(){cu.apply(this,arguments)},Ql6=function(){cu.apply(this,arguments)},AtI=function(){cu.apply(this,arguments)},xIR=function(){cu.apply(this,arguments)},L$c=function(){cu.apply(this,arguments)},BH8=function(){cu.apply(this,
arguments)},rtK=function(){cu.apply(this,arguments)},nE6=function(){cu.apply(this,arguments)},MYI=function(){cu.apply(this,arguments)},hEU=function(){cu.apply(this,arguments)},SqI=function(){cu.apply(this,arguments)},fGU=function(){cu.apply(this,arguments)},HTR=function(){cu.apply(this,arguments)},ctR=function(){cu.apply(this,arguments)},pOe=function(q){q=q.key||q.id;
if(!q)throw Error("Entity key is missing");return q},UIR=function(){if(pu)return pu();
var q={};pu=g.zA("PersistentEntityStoreDb",{Bs:(q.EntityStore={fd:1},q.EntityAssociationStore={fd:2},q),shared:!1,upgrade:function(a,w){w(1)&&g.Bh(g.J2(a,"EntityStore",{keyPath:"key"}),"entityType","entityType");w(2)&&(a=g.J2(a,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.Bh(a,"byParentEntityKey","parentEntityKey"),g.Bh(a,"byChildEntityKey","childEntityKey"))},
version:3});return pu()},XOJ=function(q){return g.ch(UIR(),q)},jlw=function(q){return g.ch((0,g.mzJ)(),q)},UG=function(q){this.token=q},Xn=function(q,a){a=a===void 0?{}:a;
g.UH.call(this,g.QT8[q],Object.assign({},{name:"PESEncoderError",type:q},a));this.type=q;this.level="WARNING";Object.setPrototypeOf(this,Xn.prototype)},oEl=function(q){return new Xn("WRONG_DATA_TYPE",{R9:q})},IG6=function(q){return q instanceof Error?new Xn("UNKNOWN_ENCODE_ERROR",{originalMessage:q.message}):new Xn("UNKNOWN_ENCODE_ERROR")},ujV=function(q){return q instanceof Error?new Xn("UNKNOWN_DECODE_ERROR",{originalMessage:q.message}):new Xn("UNKNOWN_DECODE_ERROR")},tYl=function(q,a){q=q instanceof
Xn?q:a(q);
g.mQ(q);throw q;},vE8=function(){},zEJ=function(q,a,w){try{return q.W(a,w)}catch(G){tYl(G,IG6)}},iTV=function(q){q=(new TextEncoder).encode(q).subarray(0,16);
var a=new Uint8Array(16);a.set(q);return a},jJ=function(q){this.V=q},DI7=function(q){var a=W$x[q];
if(a)return a;g.Qa(new g.UH("Entity model not found.",{entityType:q}))},REl=function(q,a){this.V=q;
this.U=a;this.W={}},qZw=function(q,a){a:{q=yt8(q.U,a.version);
try{var w=q.U(a.data,a.key);break a}catch(G){tYl(G,ujV)}w=void 0}return w},oi=function(q,a,w){return q.V.objectStore("EntityStore").get(a).then(function(G){if(G){if(w&&G.entityType!==w)throw Error("Incorrect entity type");
return qZw(q,G)}})},Ii=function(q,a,w){return w?(w=w.map(function(G){return oi(q,G,a)}),g.$7.all(w)):q.V.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(a)).then(function(G){return G.map(function(k){return qZw(q,k)})})},tJ=function(q,a,w){var G=pOe(a),k=yt8(q.U,1),b=Object.assign({},a);
return q.V.objectStore("EntityStore").get(G).then(function(O){if(O){if(O.entityType!==w)throw Error("Incorrect entity type");b.entityMetadata||(O=qZw(q,O),b.entityMetadata=O.entityMetadata)}}).then(function(){var O={key:G,
entityType:w,data:zEJ(k,b,G),version:1};return g.$7.all([g.A2(q.V.objectStore("EntityStore"),O),g8K(q,b,w)])}).then(function(){uS(q,G,w);
return G})},aXB=function(q,a,w){a=a.map(function(G){return tJ(q,G,w)});
return g.$7.all(a)},vu=function(q,a,w){if(w==null?0:w.U9){var G=new Set;
return w4y(q,a,G).then(function(){for(var b=[],O=g.V(G),e=O.next();!e.done;e=O.next())b.push(vu(q,e.value));return g.$7.all(b).then(function(){})})}var k=g.Ie(a).entityType;
return g.$7.all([q.V.objectStore("EntityStore").delete(a),GwK(q,a)]).then(function(){uS(q,a,k)})},kw6=function(q,a){return g.h2(q.V.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(a)},function(w){return g.$7.all([w.delete(),
GwK(q,w.cursor.primaryKey)]).then(function(){uS(q,w.cursor.primaryKey,a);return g.nI(w)})})},b1J=function(q,a,w,G){var k=yt8(q.U,1);
return oi(q,a,G).then(function(b){if(b){b=g.RS(b,w);var O={key:a,entityType:G,data:zEJ(k,b,a),version:1};return g.$7.all([g.A2(q.V.objectStore("EntityStore"),O),g8K(q,b,G)])}}).then(function(){uS(q,a,G);
return a})},uS=function(q,a,w){var G=q.W[w];
G||(G=new Set,q.W[w]=G);G.add(a)},O1l=function(q,a,w){var G=pOe(a);
w=DI7(w);if(!w)return g.$7.resolve([]);w=new w(a);q=q.V.objectStore("EntityAssociationStore");a=[];w=g.V(w.U());for(var k=w.next();!k.done;k=w.next())a.push(g.A2(q,{parentEntityKey:G,childEntityKey:k.value}));return g.$7.all(a).then(function(b){return b.map(function(O){return O[1]})})},GwK=function(q,a){return q.V.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(a))},g8K=function(q,a,w){var G=pOe(a);
return GwK(q,G).then(function(){return O1l(q,a,w)})},w4y=function(q,a,w){if(w.has(a))return g.$7.resolve(void 0);
w.add(a);return lXy(q,a).then(function(G){return q.V.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(a)).then(function(){return G})}).then(function(G){var k=g.$7.resolve(void 0);
G=g.V(G);for(var b=G.next(),O={};!b.done;O={CJ:void 0},b=G.next())O.CJ=b.value,k=k.then(function(e){return function(){return w4y(q,e.CJ,w)}}(O));
return k}).then(function(){})},lXy=function(q,a){var w=q.V.objectStore("EntityAssociationStore");
return w.index("byParentEntityKey").getAll(IDBKeyRange.only(a)).then(function(G){var k=[];G=g.V(G);for(var b=G.next();!b.done;b=G.next())b=b.value,k.push(w.index("byChildEntityKey").getAll(b.childEntityKey));return g.$7.all(k)}).then(function(G){var k=[];
G=g.V(G);for(var b=G.next();!b.done;b=G.next())b=b.value,b.length===1&&k.push(b[0].childEntityKey);return k})},zq=function(){},eCK=function(){this.V={};
this.V[0]=new zq;if(!g.dF("aes_pes_encoder_killswitch")){var q=this.V;try{var a=g.Xt();var w=iTV(a);var G=new jJ(new g.kW(w),new g.bP(w))}catch(k){throw q=k instanceof Error?new Xn("KEY_CREATION_FAILED",{originalMessage:k.message}):new Xn("KEY_CREATION_FAILED"),g.mQ(q),q;}q[1]=G}},yt8=function(q,a){a=a===void 0?0:a;
q=q.V[a];if(!q)throw a=new Xn("INVALID_ENCODER_VERSION",{R9:a}),g.mQ(a),a;return q},iS=function(q,a){g.c.call(this);
this.token=q;this.V=a;this.observers=[];q=new g.yV.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.Xt());q.onmessage=this.U.bind(this);this.channel=q},Wu=function(q,a,w){var G,k,b,O;
return g.h(function(e){if(e.U==1)return g.n(e,XOJ(q.token),2);if(e.U!=3)return G=e.V,g.n(e,g.Qu(G,["EntityStore","EntityAssociationStore"],a,function(N){k=new REl(N,q.V);return w(k)}),3);
b=e.V;k&&(O=k.W,Object.keys(O).length>0&&(q.channel.postMessage(O),NV7(q,O)));return e.return(b)})},Dr=function(q,a,w){return Wu(q,{mode:"readwrite",
EA:!0},function(G){return tJ(G,a,w)})},YZ7=function(q,a){return Wu(q,{mode:"readwrite",
EA:!0},function(w){return aXB(w,a,"offlineOrchestrationActionWrapperEntity")})},PlJ=function(q,a){return Wu(q,{mode:"readwrite",
EA:!0},function(w){return vu(w,a)})},Knw=function(q){return Wu(q,{mode:"readwrite",
EA:!0},function(a){return kw6(a,"videoPlaybackPositionEntity")})},Ri=function(q,a,w){return Wu(q,{mode:"readonly",
EA:!0},function(G){return oi(G,a,w)})},yU=function(q,a,w){return Wu(q,{mode:"readonly",
EA:!0},function(G){return Ii(G,a,w)})},NV7=function(q,a){q=g.V(q.observers);
for(var w=q.next();!w.done;w=q.next())w=w.value,w(a)},dA8=function(){var q,a,w;
return g.h(function(G){if(G.U==1)return g.ml(G,2),g.n(G,g.t2(),4);if(G.U!=2){q=G.V;if(!q||!g.j2()||typeof g.yV.BroadcastChannel==="undefined")return G.return();a=new eCK;return G.return(new iS(q,a))}w=g.rc(G);w instanceof Error&&g.mQ(w);return G.return()})},qB=function(){TV8||(TV8=dA8());
return TV8},$Aw=function(q){var a;
q=(a=q.options)==null?void 0:a.persistenceOption;return q==="ENTITY_PERSISTENCE_OPTION_PERSIST"||q==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},soJ=function(q){var a;
return g.h(function(w){return w.U==1?g.n(w,qB(),2):(a=w.V)?g.n(w,Wu(a,"readwrite",function(G){for(var k={},b=g.V(q),O=b.next(),e={};!O.done;e={DO:void 0,Nt:void 0},O=b.next())e.DO=O.value,e.DO.entityKey&&$Aw(e.DO)&&(e.Nt=g.wn(e.DO.payload),O=void 0,e.DO.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(O=function(N){return function(){return tJ(G,N.DO.payload[N.Nt],N.Nt)}}(e)),e.DO.type==="ENTITY_MUTATION_TYPE_DELETE"&&(O=function(N){return function(){return vu(G,N.DO.entityKey)}}(e)),e.DO.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(O=function(N){return function(){return b1J(G,N.DO.entityKey,N.DO.payload[N.Nt],N.Nt)}}(e)),O&&(k[e.DO.entityKey]=k[e.DO.entityKey]?k[e.DO.entityKey].then(O):O()));
return g.$7.all(Object.values(k))}),0):w.return()})},FnR=function(q){var a;
return g.h(function(w){if(w.U==1){a=q.mutations;if(!a||a.length<=0)return w.return();if(g.mh){var G={type:"ENTITY_LOADED"};a!==void 0&&(G.payload=a);g.mh.dispatch(G)}return g.n(w,soJ(a),2)}a.length=0;g.Jm(w)})},Cl7=function(q){return q!==void 0},Z1x=function(q){var a=g.qH();
a=Object.assign({},a);q=Object.assign({},q);for(var w in a)q[w]?(a[w]!==4&&(a[w]=q[w]),delete q[w]):a[w]!==2&&(a[w]=4);Object.assign(a,q);g.XZG(a);JSON.stringify(a);return a},E8J=function(q){var a,w;
return g.h(function(G){if(G.U==1)return g.n(G,g.t2(),2);if(G.U!=3)return(a=G.V)?g.n(G,g.wM(a),3):G.return();w=G.V;return G.return(g.Qu(w,["index","media","captions"],{mode:"readwrite",EA:!0},function(k){var b=IDBKeyRange.bound(q+"|",q+"~");k=[k.objectStore("index").delete(b),k.objectStore("media").delete(b),k.objectStore("captions").delete(b)];return g.$7.all(k).then(function(){})}))})},Vte=function(){var q,a;
return g.h(function(w){if(w.U==1)return g.n(w,g.t2(),2);if(w.U!=3){q=w.V;if(!q)throw g.dw("rvdfd");return g.n(w,g.wM(q),3)}a=w.V;return w.return(g.Qu(a,["index","media"],{mode:"readwrite",EA:!0},function(G){var k={};return g.rw(G.objectStore("index"),{},function(b){var O=b.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),e=g.$7.resolve(void 0);if(O){var N=O[1];O=O[2];k[N]=k[N]||{};var Y;k[N][O]=g.tQm((Y=b.getValue())==null?void 0:Y.fmts)}else e=b.delete().then(function(){});
return g.$7.all([g.nI(b),e]).then(function(P){return g.V(P).next().value})}).then(function(){for(var b={},O=g.V(Object.keys(k)),e=O.next();!e.done;e=O.next()){e=e.value;
var N=k[e].v;b[e]=k[e].a&&N?1:2}var Y=Z1x(b);return g.mbN(G.objectStore("media"),{},function(P){var K=P.cursor.key.match(g.Wml);K&&b[K[1]]||G.objectStore("media").delete(P.cursor.key);return g.T__(P)}).then(function(){return Y})})}))})},J$K=function(q,a){var w,G;
return g.h(function(k){if(k.U==1)return g.n(k,g.t2(),2);if(k.U!=3){w=k.V;if(!w)throw g.dw("wct");return g.n(k,g.wM(w),3)}G=k.V;return g.n(k,g.Qu(G,["captions"],{mode:"readwrite",EA:!0},function(b){var O=[];b=b.objectStore("captions");for(var e=0;e<a.length;e++){var N=g.A2(b,a[e],q+"|"+a[e].metadata.vss_id);O.push(N)}return g.$7.all(O)}),0)})},mAU=function(q){var a,w,G;
return g.h(function(k){if(k.U==1)return a=IDBKeyRange.bound(q+"|",q+"~"),g.n(k,g.t2(),2);if(k.U!=3){w=k.V;if(!w)throw g.dw("gactfv");return g.n(k,g.wM(w),3)}G=k.V;return k.return(G.getAll("captions",a))})},QoI=function(q){return g.h(function(a){g.ap(q,0);
return a.return(E8J(q))})},A$e=function(q){return{context:g.IA(),
videoIds:q}},xAl=function(q){return{context:g.IA(),
playlistIds:q}},Lne=function(q){return{context:g.IA(),
offlinePlaylistSyncChecks:q}},BVK=function(){this.V=new Map},n8c=function(){r$V||(r$V=new BVK);
return r$V},Mt7=function(q,a){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:q},metadata:a,statusCode:void 0,csn:void 0,can:void 0}},hCV=function(q,a,w){if(!w){var G=G===void 0?!1:G;
w=q.V.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!w||G)w=g.K5(16),q.V.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",w)}q={flowNonce:w,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:a.eventType};a.metadata&&(q.flowMetadata=a.metadata);a.statusCode!==void 0&&(q.flowEventStatus=a.statusCode);a.csn&&(q.csn=a.csn);a.can&&(q.can=a.can);g.aw("flowEvent",q,void 0)},SZ6=function(q){var a,w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6;
return g.h(function(hl){if(hl.U==1)return g.n(hl,Wu(q,{mode:"readonly",EA:!0},function(Gf){return Ii(Gf,"playbackData").then(function(Al){var m=Al.map(function(jK){return jK.transfer}).filter(function(jK){return!!jK}),wc=Al.map(function(jK){return jK.offlineVideoPolicy}).filter(function(jK){return!!jK}),MW=Al.filter(function(jK){return!!jK.key}).map(function(jK){return g.uH(g.Ie(jK.key).entityId,"downloadStatusEntity")});
m=Ii(Gf,"transfer",m);wc=Ii(Gf,"offlineVideoPolicy",wc);MW=Ii(Gf,"downloadStatusEntity",MW);var em=m.then(function(jK){jK=jK.reduce(function(zf,wy){(wy==null?0:wy.offlineVideoStreams)&&zf.push.apply(zf,g.Tf(wy.offlineVideoStreams));return zf},[]).filter(function(zf){return!!zf});
return Ii(Gf,"offlineVideoStreams",jK)});
return g.$7.all([m,wc,em,MW]).then(function(jK){var zf=g.V(jK);jK=zf.next().value;var wy=zf.next().value;var as=zf.next().value;zf=zf.next().value;return[Al,jK,wy,as,zf]})})}),2);
if(hl.U!=3)return a=hl.V,g.n(hl,Wu(q,{mode:"readonly",EA:!0},function(Gf){return Ii(Gf,"mainDownloadsListEntity").then(function(Al){var m,wc;return(wc=(m=Al[0])==null?void 0:m.downloads)!=null?wc:[]})}),3);
w=hl.V;G=g.V(a);k=G.next().value;b=G.next().value;O=G.next().value;e=G.next().value;N=G.next().value;Y=k;P=b;K=O;d=e;T=N;F={};J={};Q={};B={};L={};M=[];H=g.V(P);for(X=H.next();!X.done;X=H.next())(D=X.value)&&(F[D.key]=D);z=g.V(K);for(Oj=z.next();!Oj.done;Oj=z.next())($l=Oj.value)&&(J[$l.key]=$l);ey=g.V(T);for(Nm=ey.next();!Nm.done;Nm=ey.next())(a_=Nm.value)&&(Q[a_.key]=a_);BJ=g.V(d);for(WJ=BJ.next();!WJ.done;WJ=BJ.next())(gy=WJ.value)&&(B[gy.key]=gy);F8=g.V(w);for(eK=F8.next();!eK.done;eK=F8.next())Mm=
eK.value,O7=void 0,L[(O7=Mm.videoItem)!=null?O7:""]=!0,Mm.videoItem&&(uV=cR=void 0,lb=(uV=(cR=g.Ie(Mm.videoItem))==null?void 0:cR.entityId)!=null?uV:"",M.push({externalVideoId:lb}));r=Y.filter(function(Gf){if(!Gf||!Gf.key||!Gf.offlineVideoPolicy)return!1;Gf=g.Ie(Gf.key).entityId;Gf=g.uH(Gf,"downloadStatusEntity");var Al;return!(Gf&&((Al=Q[Gf])==null?void 0:Al.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
o6=r.map(function(Gf){var Al=F[Gf.transfer],m=[];if(Al==null?0:Al.offlineVideoStreams)for(var wc=g.V(Al.offlineVideoStreams),MW=wc.next();!MW.done;MW=wc.next())(MW=B[MW.value])&&m.push(MW);wc=J[Gf.offlineVideoPolicy];MW=L;var em=Gf==null?void 0:Gf.playerResponseTimestamp,jK=g.Ie(wc.key).entityId;Gf=g.uH(jK,"mainVideoEntity");if(wc.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var zf="OFFLINE_VIDEO_STATE_DISABLED";wc.expirationTimestamp&&Number(wc.expirationTimestamp)<Date.now()/1E3&&(zf="OFFLINE_VIDEO_STATE_EXPIRED")}else if(wc.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")zf="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(Al==null?void 0:Al.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":zf="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":zf="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":zf="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":zf="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":zf="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":zf="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:zf="OFFLINE_VIDEO_STATE_UNKNOWN"}if(zf==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(Al==null?void 0:Al.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":zf="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":zf="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":zf=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}jK={id:jK,videoState:zf};if(Al==null?0:Al.cotn)jK.cotn=Al.cotn;if(Al==null?0:Al.maximumDownloadQuality)jK.selectedVideoQuality=Al==null?void 0:Al.maximumDownloadQuality;if(Al==null?0:Al.lastProgressTimeMs)jK.lastProgressTimeMs=Al.lastProgressTimeMs;em&&(jK.playerResponseSavedTimeMs=String(Number(em)*1E3));Al=String;em=0;m=g.V(m);for(zf=m.next();!zf.done;zf=m.next())if(zf=zf.value,zf.streamsProgress){zf=g.V(zf.streamsProgress);for(var wy=zf.next();!wy.done;wy=zf.next()){var as=
void 0;em+=Number((as=wy.value.numBytesDownloaded)!=null?as:0)}}jK.downloadedBytes=Al(em);jK.selectedOfflineMode=MW[Gf]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";wc.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(jK.offlinePlaybackDisabledReason=wc.offlinePlaybackDisabledReason);return jK});
return hl.return({offlineVideos:o6,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:M}}})})},fXc=function(){this.locks=navigator.locks},H1B=function(){try{var q=g.aB("ytglobal.locks_");
if(q)return q;var a;if(a=navigator){var w=navigator;a="locks"in w&&!!w.locks}if(a)return g.yV.localStorage&&g.yV.localStorage.getItem("noop"),q=new fXc,g.qe("ytglobal.locks_",q),q}catch(G){}},go=function(){},c$w=function(){},p4l=function(q){if(q.includes(":"))throw Error("Invalid user cache name: "+q);
return q+":"+g.Xt("CacheStorage get")},UA8=function(){return g.h(function(q){if(ay!==void 0)return q.return(ay);
ay=new Promise(function(a){var w;return g.h(function(G){switch(G.U){case 1:return g.ml(G,2),g.n(G,wo.open("test-only"),4);case 4:return g.n(G,wo.delete("test-only"),5);case 5:g.xl(G,3);break;case 2:if(w=g.rc(G),w instanceof Error&&w.name==="SecurityError")return a(!1),G.return();case 3:a("caches"in window),g.Jm(G)}})});
return q.return(ay)})},jol=function(){return g.h(function(q){if(q.U==1)return g.n(q,UA8(),2);
if(!q.V)return q.return(void 0);X4R||(X4R=new c$w);return q.return(X4R)})},Ga=function(q,a,w){g.Qa(new g.UH("Woffle: "+q,w?{cotn:w}:""));
a instanceof Error&&g.Qa(a)},o8V=function(q){var a;
return g.h(function(w){if(w.U==1)return g.n(w,SZ6(q),2);a=w.V;g.aw("offlineStateSnapshot",a);g.Jm(w)})},k2=function(q){g.c.call(this);
var a=this;this.api=q;this.qh={WFQ:function(){return a.V},
ehB:function(){return a.U}};
typeof g.yV.BroadcastChannel!=="undefined"&&(this.V=new g.yV.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.Xt()),this.V.onmessage=this.W.bind(this),this.U=new g.yV.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.Xt()),this.U.onmessage=this.Y.bind(this))},bC=function(q,a){q.api.zl("onOfflineOperationFailure",a);
var w;(w=q.V)==null||w.postMessage(a)},IX7=function(q,a,w){var G=this;
this.S=q;this.J=a;this.visibility=w;this.D=this.X=this.L=this.W=this.V=!1;this.Y=new g.o1(function(){G.XM()});
this.qh={X_:function(){return G.U},
XM:function(){G.XM()},
ws2:function(){return G.Y}};
this.visibility.subscribe("visibilitystatechange",function(){G.wx()})},uSw=function(q){if(!q.W&&!q.V){var a=H1B();
if(a){q.W=!0;var w=g.Xt("OfflineLockManager");a.request("woffle_orchestration_leader:"+w,{},function(){var G,k;return g.h(function(b){switch(b.U){case 1:return g.ml(b,2),q.U=new g.Y8,q.V=!0,q.W=!1,g.n(b,q.S(),4);case 4:return g.n(b,q.U.promise,5);case 5:g.xl(b,0);break;case 2:G=g.rc(b),q.XM(),G instanceof Error&&(k=G,k.args=[{name:"WoLockManagerError",IV:G.name}],g.mQ(k)),g.Jm(b)}})})}}},tt6=function(q){q.V&&(q.D=!0,OW(q))},v8R=function(q,a){q.V&&(q.L=a,OW(q))},zC6=function(q,a){q.V&&(q.X=a,OW(q))},
OW=function(q){q.X&&q.L&&q.D&&q.visibility.isBackground()?g.tD(q.Y,6E4):q.Y.stop()},lC=function(q){var a;
q.offlineDeleteReason=(a=q.offlineDeleteReason)!=null?a:"OFFLINE_DELETE_REASON_UNKNOWN";var w;q.offlineModeType=(w=q.offlineModeType)!=null?w:"OFFLINE_NOW";g.aw("offlineDeleteEvent",q)},eq=function(q,a){var w=a.videoId;
var G=a.C3;a=a.offlineModeType;q.encryptedVideoId=w;q.cotn=G==null?void 0:G.cotn;q.offlineabilityFormatType=G==null?void 0:G.maximumDownloadQuality;var k;q.isRefresh=(k=G==null?void 0:G.isRefresh)!=null?k:!1;var b;q.softErrorCount=(b=G==null?void 0:G.transferRetryCount)!=null?b:0;q.offlineModeType=a!=null?a:"OFFLINE_NOW";(q.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&q.statusType==="UNKNOWN_STATUS_TYPE"||!q.transferStatusType&&!q.statusType)&&g.Qa(Error("Woffle unknown transfer status"));
g.aw("offlineTransferStatusChanged",q)},i1l=function(q){eq({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",
statusType:"ADDED_TO_QUEUE"},q)},Wn6=function(q,a,w,G){G={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!G};a&&w&&(a=Math.floor(a/1024).toFixed(),w=Math.floor(w/1024).toFixed(),G.alreadyDownloadedKbytes=a,G.totalFetchedKbytes=a,G.totalContentKbytes=w);eq(G,q)},DA7=function(q){eq({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},q)},RCK=function(q){eq({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},q)},y$x=function(q){switch(q){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
NB=function(q){var a,w,G;
return((G=(a=q.actionMetadata)==null?void 0:(w=a.retryScheduleIntervalsInSeconds)==null?void 0:w.length)!=null?G:0)>0},Y2=function(q){return q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!q.entityKey},PM=function(q){return q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!q.entityKey},Kq=function(q){return q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!q.entityKey},q57=function(q){return q.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!q.entityKey},
Ta=function(q,a,w,G,k){k=k===void 0?!1:k;
var b,O,e,N,Y,P;return g.h(function(K){if(K.U==1)return b=g.uH(q,a),O=g.uH(q,"downloadStatusEntity"),g.n(K,Wu(w,{mode:"readonly",EA:!0},function(d){return g.$7.all([oi(d,b,a),oi(d,O,"downloadStatusEntity")])}),2);
e=K.V;N=e.length?e[0]:void 0;if(!N)return K.Gl(0);Y=gsU;if(P=e.length>1?e[1]:void 0){if(P.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!k)return K.return();P.downloadState=G}else P={key:O,downloadState:G};g.rI(N,Y,P);return g.n(K,Wu(w,{mode:"readwrite",EA:!0},function(d){return g.$7.all([tJ(d,N,a),tJ(d,P,"downloadStatusEntity")])}),0)})},$2=function(q,a){return q.actionType===a.actionType&&q.entityKey===a.entityKey},sW=function(q,a){if(q&&q.transferState!=="TRANSFER_STATE_COMPLETE"&&q.transferState!==
"TRANSFER_STATE_FAILED"){var w=g.Ie(q.key).entityId;
eq({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:w,C3:q,offlineModeType:a})}},F6=function(q){if(!q||!q.thumbnails)return[];
var a=[];q=g.V(q.thumbnails);for(var w=q.next();!w.done;w=q.next())w=w.value,w.url&&a.push(w.url);return a},aHK=function(q,a,w){w=w===void 0?[]:w;
var G,k,b,O,e,N,Y,P,K,d,T,F,J;return g.h(function(Q){if(Q.U==1)return w.length?g.n(Q,yU(q,a),2):Q.return([]);G=Q.V;k=new Set;b=g.V(G);for(O=b.next();!O.done;O=b.next())if(e=O.value,N=e.id||e.key)Y=g.Ie(N).entityId,k.add(Y);P=[];K=g.V(w);for(d=K.next();!d.done;d=K.next())T=d.value,F=T.offlineVideoData,J=void 0,((J=F)==null?0:J.videoId)&&!k.has(F.videoId)&&P.push(T);return Q.return(P)})},wv8=function(q,a,w){return new g.TO(q,{cotn:a,
raw_player_response:w,download_media:!0,start:Infinity,disable_watch_next:!0})},GEc=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},Cq=function(q,a,w,G,k,b,O,e,N,Y,P){this.entityType=q;
this.actionId=a;this.action=w;this.parentActionId=G;this.rootActionId=k===void 0?a:k;this.childActionIds=b;this.prereqActionId=O;this.postreqActionIds=e;this.hasChildActionFailed=Y;this.retryScheduleIndex=0;this.V=P||Date.now();this.retryScheduleIndex=N||0},ZC=function(q){if(!q.key)throw Error("Entity key is required.");
if(!q.actionProto)throw Error("OfflineOrchestrationAction is required.");var a=g.Ie(q.key),w=g.Ie(q.actionProto.entityKey);return new Cq(w.entityType,a.entityId,q.actionProto,q.parentActionId,q.rootActionId,q.childActionIds,q.prereqActionId,q.postreqActionIds,q.retryScheduleIndex,q.hasChildActionFailed,Number(q.enqueueTimeSec)*1E3)},EW=function(q){return{key:g.uH(q.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:q.action,parentActionId:q.parentActionId,rootActionId:q.rootActionId,childActionIds:q.childActionIds,prereqActionId:q.prereqActionId,postreqActionIds:q.postreqActionIds,retryScheduleIndex:q.retryScheduleIndex,hasChildActionFailed:q.hasChildActionFailed,enqueueTimeSec:(q.V/1E3).toFixed()}},kEl=function(){var q;
return g.h(function(a){return a.U==1?g.n(a,jol(),2):(q=a.V)?a.return(q.delete("yt-player-local-img")):a.return(!0)})},V3=function(q){var a,w;
return g.h(function(G){if(G.U==1)return g.n(G,jol(),2);if(G.U!=3){a=G.V;if(!a)throw Error("Cache API not supported");return q.length?g.n(G,a.open("yt-player-local-img"),3):G.return()}w=G.V;return g.n(G,Promise.all(q.map(function(k){return w.delete(k)})),0)})},JC=function(q){var a,w;
return g.h(function(G){if(G.U==1)return g.n(G,jol(),2);if(G.U!=3){a=G.V;if(!a)throw Error("Cache API not supported");return q.length?g.n(G,a.open("yt-player-local-img"),3):G.return()}w=G.V;return g.n(G,w.addAll(q),0)})},mg=function(q,a,w,G,k){var b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7;
return g.h(function(cR){switch(cR.U){case 1:return b=g.uH(q,"mainVideoEntity"),O=g.uH(q,"ytMainChannelEntity"),e=g.uH(q,"transfer"),N=g.uH(q,"videoDownloadContextEntity"),g.n(cR,Wu(a,{mode:"readonly",EA:!0},function(uV){return g.$7.all([oi(uV,b,"mainVideoEntity"),oi(uV,O,"ytMainChannelEntity"),oi(uV,e,"transfer"),oi(uV,N,"videoDownloadContextEntity"),Ii(uV,"ytMainChannelEntity"),Ii(uV,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Y=cR.V;P=g.V(Y);K=P.next().value;d=P.next().value;T=P.next().value;F=P.next().value;J=P.next().value;Q=P.next().value;B=K;L=d;M=T;H=F;X=J;D=Q;if(!B&&!L){cR.Gl(3);break}z=B?F6(B.thumbnail):[];if(!L){Oj=[];cR.Gl(4);break}return g.n(cR,bJx(L,X),5);case 5:Oj=cR.V;case 4:return $l=Oj,g.n(cR,V3(z.concat($l)),3);case 3:ey=[];Nm=g.uH(q,"downloadStatusEntity");a_=g.V(D);for(BJ=a_.next();!BJ.done;BJ=a_.next())WJ=BJ.value,gy=g.Ie(WJ.key).entityId,F8=ZC(WJ),eK=g.Ie(F8.action.entityKey).entityId,gy!==q&&
eK!==q||$2(w,WJ.actionProto)||ey.push(WJ.key);return g.n(cR,Wu(a,{mode:"readwrite",EA:!0},function(uV){var lb=ey.map(function(r){return vu(uV,r)});
lb.push(vu(uV,b,{U9:!0}));lb.push(vu(uV,Nm,{U9:!0}));return g.$7.all(lb)}),7);
case 7:O7=(Mm=H)==null?void 0:Mm.offlineModeType,k&&(lC(k),k.offlineModeType&&(O7=k.offlineModeType)),sW(M,O7),bC(G,{entityKey:b,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Jm(cR)}})},esx=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6,hl,Gf,Al,m,wc,MW,em,jK,zf,wy,as,I6,A;
return g.h(function(E){switch(E.U){case 1:return k=g.uH(q,"mainPlaylistEntity"),b=g.uH(q,"ytMainChannelEntity"),g.n(E,Wu(a,{mode:"readonly",EA:!0},function(x){return g.$7.all([oi(x,k,"mainPlaylistEntity"),oi(x,b,"ytMainChannelEntity"),Ii(x,"mainPlaylistEntity"),Ii(x,"mainDownloadsListEntity"),Ii(x,"ytMainChannelEntity"),Ii(x,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:O=E.V;e=g.V(O);N=e.next().value;Y=e.next().value;P=e.next().value;K=e.next().value;d=e.next().value;T=e.next().value;F=N;J=Y;Q=P;B=K;L=d;M=T;if(!F&&!J){E.Gl(3);break}H=F?OJc(F):[];if(!J){X=[];E.Gl(4);break}return g.n(E,bJx(J,L),5);case 5:X=E.V;case 4:return D=X,g.n(E,V3(H.concat(D)),3);case 3:z=[];Oj=new Map;if(!F){E.Gl(7);break}return g.n(E,lH8(F,Q,B),8);case 8:z=E.V;$l=g.V(z);for(ey=$l.next();!ey.done;ey=$l.next())Nm=ey.value,Oj.set(Nm,{videoId:Nm,playlistId:q,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.n(E,Wu(a,{mode:"readonly",EA:!0},function(x){return g.$7.all([Ii(x,"transfer"),Ii(x,"videoDownloadContextEntity")])}),9);
case 9:a_=E.V;BJ=g.V(a_);WJ=BJ.next().value;gy=BJ.next().value;F8=WJ;eK=gy;Mm=g.V(F8);for(O7=Mm.next();!O7.done;O7=Mm.next())cR=O7.value,uV=g.Ie(cR.key).entityId,(lb=Oj.get(uV))&&cR&&(lb.cotn=cR.cotn);r=g.V(eK);for(o6=r.next();!o6.done;o6=r.next())hl=o6.value,Gf=g.Ie(hl.key).entityId,(Al=Oj.get(Gf))&&hl&&(Al.offlineModeType=hl.offlineModeType);case 7:m=[];wc=g.V(M);for(MW=wc.next();!MW.done;MW=wc.next())em=MW.value,jK=g.Ie(em.key).entityId,zf=ZC(em),jK!==q&&zf.rootActionId!==q||$2(w,em.actionProto)||
m.push(em.key);wy=g.uH(q,"mainPlaylistEntity");return g.n(E,Wu(a,{mode:"readwrite",EA:!0},function(x){var S=m.map(function(U){return vu(x,U)});
S.push(vu(x,wy,{U9:!0}));return g.$7.all(S)}),10);
case 10:if(!F){E.Gl(0);break}z.reverse();if(!z){E.Gl(0);break}as=g.V(z);I6=as.next();case 13:if(I6.done){E.Gl(0);break}A=I6.value;return g.n(E,mg(A,a,w,G,Oj.get(A)),14);case 14:I6=as.next(),E.Gl(13)}})},Y5R=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d;
return g.h(function(T){if(T.U==1)return k=g.uH("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),b=new Map,g.n(T,Wu(q,{mode:"readwrite",EA:!0},function(F){var J=Ii(F,"transfer"),Q=Ii(F,"offlineOrchestrationActionWrapperEntity"),B=Ii(F,"videoDownloadContextEntity"),L=oi(F,k,"mainDownloadsListEntity");return g.$7.all([J,Q,B,L]).then(function(M){M=g.V(M);var H=M.next().value;var X=M.next().value;var D=M.next().value;var z=M.next().value;M=N_8.map(function($l){return kw6(F,$l)});
X=g.V(X);for(var Oj=X.next();!Oj.done;Oj=X.next())Oj=Oj.value,$2(a,Oj.actionProto)||M.push(vu(F,Oj.key,{U9:!0}));z&&(z.downloads=[],M.push(tJ(F,z,"mainDownloadsListEntity")));if(D)for(D=g.V(D),z=D.next();!z.done;z=D.next())z=z.value,X=g.Ie(z.key).entityId,X=g.uH(X,"transfer"),b.set(X,z.offlineModeType);return g.$7.all(M).then(function(){return H})})}),2);
O=T.V;e=g.V(O);for(N=e.next();!N.done;N=e.next())Y=N.value,sW(Y,b.get(Y.key)),P=g.Ie(Y.key).entityId,K={videoId:P,offlineDeleteReason:G,cotn:Y.cotn,offlineModeType:b.get(Y.key)},lC(K),d=g.uH(P,"mainVideoEntity"),bC(w,{entityKey:d,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.n(T,kEl(),0)})},OJc=function(q,a){var w=[];
if(q.thumbnailStyleData){q=g.V(q.thumbnailStyleData);for(var G=q.next();!G.done;G=q.next()){var k=void 0,b=void 0,O=void 0;w=w.concat(F6((k=G.value)==null?void 0:(b=k.value)==null?void 0:(O=b.collageThumbnail)==null?void 0:O.coverThumbnail))}}a=F6(a);return w.concat(a)},lH8=function(q,a,w){var G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l;
return g.h(function(ey){G=[];k=new Set;if(w.length)for(b=g.V(w),O=b.next();!O.done;O=b.next())if(e=O.value,N=void 0,(N=e.downloads)==null?0:N.length)for(Y=g.V(e.downloads),P=Y.next();!P.done;P=Y.next())K=P.value,K.videoItem&&(d=g.Ie(K.videoItem).entityId,k.add(d));if(q.videos){T=g.V(q.videos);for(F=T.next();!F.done;F=T.next())J=F.value,Q=JSON.parse(g.Ie(J).entityId),Q.videoId&&!k.has(Q.videoId)&&G.push(Q.videoId);B=g.V(a);for(L=B.next();!L.done;L=B.next())if(M=L.value,M.key!==q.key&&(H=M.videos))for(X=
g.V(H),D=X.next();!D.done;D=X.next())z=D.value,Oj=JSON.parse(g.Ie(z).entityId),Oj.videoId&&($l=G.indexOf(Oj.videoId),$l!==-1&&G.splice($l,1))}return ey.return(G)})},bJx=function(q,a){var w,G,k,b,O,e,N,Y;
return g.h(function(P){w=F6(q.avatar);G=g.V(a);for(k=G.next();!k.done;k=G.next())if(b=k.value,b.id!==q.id)for(O=g.V(F6(b.avatar)),e=O.next();!e.done;e=O.next())N=e.value,Y=w.indexOf(N),Y!==-1&&w.splice(Y,1);return P.return(w)})},PX6=function(q){var a;
return g.h(function(w){a=g.I(q.frameworkUpdates,Q3);return q.frameworkUpdates&&a?g.n(w,FnR(a),0):w.return()})},dbU=function(q){var a;
if((a=q.onResponseReceivedActions)!=null&&a.length){var w;q=(w=g.I(g.I(q.onResponseReceivedActions[0],KYV),g.Ch7))==null?void 0:w.actions;if(q!=null&&q.length)return q}},T_B=function(q){var a,w,G;
return g.h(function(k){if(k.U==1)return q?g.n(k,Ri(q,g.H_,"mainDownloadsListEntity"),2):k.return([]);a=k.V;return((w=a)==null?0:(G=w.downloads)==null?0:G.length)?k.return(a.downloads.map(function(b){var O;return(O=b.videoItem)!=null?O:""})):k.return([])})},s1y=function(q,a){var w;
return g.h(function(G){return G.U==1?g.n(G,$bR(q,a),2):(w=G.V)?g.n(G,Wu(q,{mode:"readwrite",EA:!0},function(k){var b=[tJ(k,w.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];w.mainDownloadsListEntity&&b.push(tJ(k,w.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.$7.all(b)}),0):G.Gl(0)})},$bR=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M;
return g.h(function(H){if(H.U==1)return w=g.uH("main_downloads_library_id","mainDownloadsLibraryEntity"),G=g.uH("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.n(H,Wu(q,{mode:"readonly",EA:!0},function(X){return g.$7.all([oi(X,w,"mainDownloadsLibraryEntity"),oi(X,G,"mainDownloadsListEntity")])}),2);
k=H.V;b=g.V(k);O=b.next().value;e=b.next().value;N=O;Y=e;N||(N={id:w});P=g.V(a);for(K=P.next();!K.done;K=P.next())if(d=K.value,d===g.H_){if(N.smartDownloadsList)return H.return();N.smartDownloadsList=d}else if(T=g.Ie(d).entityType,F={},T==="mainPlaylistEntity"?F.playlistItem=d:T==="mainVideoEntity"&&(F.videoItem=d),!g.KH(F)){J=void 0;if((J=Y)==null?0:J.downloads){Q=!1;B=g.V(Y.downloads);for(L=B.next();!L.done;L=B.next())if(M=L.value,M.playlistItem===d||M.videoItem===d){Q=!0;break}Q||Y.downloads.push(F)}else Y=
{id:G,downloads:[F]};N.downloadsList=G}return H.return({mainDownloadsLibraryEntity:N,mainDownloadsListEntity:Y})})},FYB=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q;
return g.h(function(B){if(B.U==1)return w=g.uH("main_downloads_library_id","mainDownloadsLibraryEntity"),G=g.uH("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.n(B,Wu(q,{mode:"readonly",EA:!0},function(L){return g.$7.all([oi(L,w,"mainDownloadsLibraryEntity"),oi(L,G,"mainDownloadsListEntity"),oi(L,g.H_,"mainDownloadsListEntity")])}),2);
k=B.V;b=g.V(k);O=b.next().value;e=b.next().value;N=b.next().value;Y=O;P=e;K=N;if(!Y)return B.Gl(0);if(a===g.H_&&((d=K)==null?0:d.downloads))K.downloads=[];else if((T=P)==null?0:T.downloads)for(F=g.Ie(a).entityType,J=0;J<P.downloads.length;J++)if(Q=P.downloads[J],F==="mainVideoEntity"&&Q.videoItem===a){P.downloads.splice(J,1);break}else if(F==="mainPlaylistEntity"&&Q.playlistItem===a){P.downloads.splice(J,1);break}return g.n(B,Wu(q,{mode:"readwrite",EA:!0},function(L){var M=[tJ(L,Y,"mainDownloadsLibraryEntity")];
P&&M.push(tJ(L,P,"mainDownloadsListEntity"));K&&M.push(tJ(L,K,"mainDownloadsListEntity"));return g.$7.all(M)}),0)})},AC=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d;
return g.h(function(T){if(T.U==1)return w=g.uH(a,"transfer"),G=g.uH(a,"videoDownloadContextEntity"),g.n(T,Wu(q,{mode:"readonly",EA:!0},function(F){return g.$7.all([oi(F,w,"transfer"),oi(F,G,"videoDownloadContextEntity")])}),2);
k=T.V;b=g.V(k);O=b.next().value;e=b.next().value;N=O;Y=e;d={videoId:a,cotn:(P=N)==null?void 0:P.cotn,offlineModeType:(K=Y)==null?void 0:K.offlineModeType};return T.return(d)})},x2=function(q,a,w,G,k){var b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj;
return g.h(function($l){switch($l.U){case 1:return b=g.uH(q,"musicTrack"),O=g.uH(q,"transfer"),g.n($l,Wu(a,{mode:"readonly",EA:!0},function(ey){return g.$7.all([oi(ey,b,"musicTrack"),oi(ey,O,"transfer"),Ii(ey,"musicTrack"),Ii(ey,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:e=$l.V;N=g.V(e);Y=N.next().value;P=N.next().value;K=N.next().value;d=N.next().value;T=Y;F=P;J=K;Q=d;if(!T){$l.Gl(3);break}return g.n($l,CX8(T,J),4);case 4:return B=$l.V,g.n($l,V3(B),3);case 3:L=[];M=g.V(Q);for(H=M.next();!H.done;H=M.next())X=H.value,D=g.Ie(X.key).entityId,z=ZC(X),Oj=g.Ie(z.action.entityKey).entityId,D!==q&&Oj!==q||$2(w,X.actionProto)||L.push(X.key);return g.n($l,Wu(a,{mode:"readwrite",EA:!0},function(ey){var Nm=L.map(function(a_){return vu(ey,a_)});
Nm.push(vu(ey,b,{U9:!0}));return g.$7.all(Nm)}),6);
case 6:sW(F),k&&lC(k),bC(G,{entityKey:b,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.Jm($l)}})},Lq=function(q,a,w,G,k){var b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6;
return g.h(function(hl){switch(hl.U){case 1:return b=g.uH(q,a),O=g.uH("music_downloads_library_id","musicDownloadsLibraryEntity"),g.n(hl,Wu(w,{mode:"readonly",EA:!0},function(Gf){return g.$7.all([oi(Gf,b,a),oi(Gf,O,"musicDownloadsLibraryEntity"),Ii(Gf,a),Ii(Gf,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:e=hl.V;N=g.V(e);Y=N.next().value;P=N.next().value;K=N.next().value;d=N.next().value;T=Y;F=P;J=K;Q=d;if(!T){hl.Gl(3);break}return g.n(hl,CX8(T,J),4);case 4:return B=hl.V,g.n(hl,V3(B),3);case 3:L=[];M=new Map;if(!T){hl.Gl(6);break}return g.n(hl,ZJe(T,J,F),7);case 7:L=hl.V;H=g.V(L);for(X=H.next();!X.done;X=H.next())D=X.value,z=g.Ie(D).entityId,M.set(z,{videoId:z,playlistId:q,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.n(hl,yU(w,"transfer"),8);case 8:for(Oj=hl.V,$l=
g.V(Oj),ey=$l.next();!ey.done;ey=$l.next())Nm=ey.value,a_=g.Ie(Nm.key).entityId,(BJ=M.get(a_))&&Nm&&(BJ.cotn=Nm.cotn);case 6:WJ=[];gy=g.V(Q);for(F8=gy.next();!F8.done;F8=gy.next())eK=F8.value,Mm=g.Ie(eK.key).entityId,O7=ZC(eK),Mm!==q&&O7.rootActionId!==q||$2(G,eK.actionProto)||WJ.push(eK.key);cR=g.uH(q,a);return g.n(hl,Wu(w,{mode:"readwrite",EA:!0},function(Gf){var Al=WJ.map(function(m){return vu(Gf,m)});
Al.push(vu(Gf,cR,{U9:!0}));return g.$7.all(Al)}),9);
case 9:if(!T){hl.Gl(0);break}L.reverse();if(!L.length){hl.Gl(0);break}uV=g.V(L);lb=uV.next();case 12:if(lb.done){hl.Gl(0);break}r=lb.value;o6=g.Ie(r).entityId;if(!o6){hl.Gl(13);break}return g.n(hl,x2(o6,w,G,k,M.get(o6)),13);case 13:lb=uV.next(),hl.Gl(12)}})},BM=function(q,a,w){var G,k,b,O,e,N,Y;
return g.h(function(P){if(P.U==1)return g.n(P,Wu(q,{mode:"readwrite",EA:!0},function(K){var d=Ii(K,"transfer"),T=Ii(K,"offlineOrchestrationActionWrapperEntity");return g.$7.all([d,T]).then(function(F){F=g.V(F);var J=F.next().value;var Q=F.next().value;F=EsR.map(function(H){return kw6(K,H)});
Q=g.V(Q);for(var B=Q.next();!B.done;B=Q.next()){B=B.value;var L=g.Ie(B.actionProto.entityKey).entityType==="musicTrack",M=B.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";$2(a,B.actionProto)||L&&(!L||M)||F.push(vu(K,B.key,{U9:!0}))}return g.$7.all(F).then(function(){return J})})}),2);
G=P.V;k=g.V(G);for(b=k.next();!b.done;b=k.next())O=b.value,sW(O),e=g.Ie(O.key).entityId,N={videoId:e,offlineDeleteReason:void 0,cotn:O.cotn},lC(N),Y=g.uH(e,"musicTrack"),bC(w,{entityKey:Y,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.n(P,kEl(),0)})},Vdw=function(q){for(var a,w=g.V(q.additionalMetadatas),G=w.next();!G.done;G=w.next())G=G.value,G.offlineMusicVideoData&&(a=G.offlineMusicVideoData);
var k,b,O,e,N;return{id:g.uH(q.videoId,"musicTrack"),videoId:q.videoId,title:q.title,thumbnailDetails:q.thumbnail,lengthMs:String(Number(q.lengthSeconds)*1E3),albumTitle:(k=a)==null?void 0:k.releaseTitle,musicVideoType:(b=a)==null?void 0:b.musicVideoType,contentRating:{explicitType:(O=a)==null?void 0:O.explicitType},artistNames:((e=a)==null?void 0:e.byline)||((N=a)==null?void 0:N.channelName),downloadMetadata:g.uH(q.videoId,"musicTrackDownloadMetadataEntity")}},ZJe=function(q,a,w){var G,k,b,O,e,N,
Y,P,K,d,T,F,J,Q,B,L,M,H;
return g.h(function(X){G=[];k=new Set;if((b=w)==null?0:(O=b.downloadedTracks)==null?0:O.length)for(e=g.V(w.downloadedTracks),N=e.next();!N.done;N=e.next())Y=N.value,k.add(Y);if(q.tracks){P=g.V(q.tracks);for(K=P.next();!K.done;K=P.next())d=K.value,k.has(d)||G.push(d);T=g.V(a);for(F=T.next();!F.done;F=T.next())if(J=F.value,J.id!==q.id&&(Q=J.tracks))for(B=g.V(Q),L=B.next();!L.done;L=B.next())M=L.value,H=G.indexOf(M),H!==-1&&G.splice(H,1)}return X.return(G)})},CX8=function(q,a){var w,G,k,b,O,e,N,Y;
return g.h(function(P){w=F6(q.thumbnailDetails);G=g.V(a);for(k=G.next();!k.done;k=G.next())if(b=k.value,b.id!==q.id)for(O=g.V(F6(b.thumbnailDetails)),e=O.next();!e.done;e=O.next())N=e.value,Y=w.indexOf(N),Y!==-1&&w.splice(Y,1);return P.return(w)})},JDK=function(q,a){var w,G,k,b,O,e,N,Y,P;
return g.h(function(K){if(K.U==1)return w=g.uH("music_downloads_library_id","musicDownloadsLibraryEntity"),g.n(K,Ri(q,w,"musicDownloadsLibraryEntity"),2);(G=K.V)||(G={id:w});k=g.Ie(a).entityType;k==="musicTrack"?(b=G.downloadedTracks)!=null&&b.includes(a)||(G.downloadedTracks=((O=G.downloadedTracks)!=null?O:[]).concat(a)):k==="musicPlaylist"?(e=G.downloadedPlaylists)!=null&&e.includes(a)||(G.downloadedPlaylists=((N=G.downloadedPlaylists)!=null?N:[]).concat(a)):k!=="musicAlbumRelease"||(Y=G.downloadedAlbumReleases)!=
null&&Y.includes(a)||(G.downloadedAlbumReleases=((P=G.downloadedAlbumReleases)!=null?P:[]).concat(a));return g.n(K,Dr(q,G,"musicDownloadsLibraryEntity"),0)})},mbI=function(q,a){var w,G,k,b,O,e,N;
return g.h(function(Y){if(Y.U==1)return w=g.uH("music_downloads_library_id","musicDownloadsLibraryEntity"),g.n(Y,Ri(q,w,"musicDownloadsLibraryEntity"),2);G=Y.V;if(!G)return Y.Gl(0);k=g.Ie(a).entityType;k==="musicTrack"?b=G.downloadedTracks:k==="musicPlaylist"&&(b=G.downloadedPlaylists);if((O=b)==null?0:O.length)for(e=0;e<b.length;e++)if(N=b[e],N===a){b.splice(e,1);break}return g.n(Y,Dr(q,G,"musicDownloadsLibraryEntity"),0)})},Q16=function(q){var a=q.videos;
q=[];var w=[];if(a){a=g.V(a);for(var G=a.next();!G.done;G=a.next()){var k=G.value.offlineVideoData.videoId;G=g.uH(k,"musicTrack");k=g.uH(k,"musicTrackDownloadMetadataEntity");q.push(G);w.push(k)}}return{SY:q,Cp:w}},ro=function(q,a,w){a={track:Vdw(a)};
w&&(a.playlistId=w);if(q=g.I(q.actionMetadata,ADB))a.maximumDownloadQuality=q.maximumDownloadQuality;return{musicTrackEntityActionMetadata:a}},LYc=function(q){var a,w,G,k,b,O,e,N;
return g.h(function(Y){switch(Y.U){case 1:return a=g.X2(),w=A$e(q),G=g.vA(xbx),g.ml(Y,2),b={Hs:!0},g.n(Y,g.Bt(a,w,G,void 0,b),4);case 4:k=Y.V;g.xl(Y,3);break;case 2:O=g.rc(Y);if(O instanceof g.ct)throw e="GetOffline network manager error: "+O.message,Ga(e,O),Error(e);Ga("GetOffline fetch request error",O);throw Error("GetOffline fetch request error");case 3:N=nq(k);if(!k)throw Ga("Network request failed"),Error("Network request failed");if(N!==void 0)MB(N);else if(!k.videos||!k.videos.length)throw Ga("No data"),
Error("No data");return Y.return(k.videos.map(function(P){return P.offlineVideoData}))}})},B_B=function(q){var a,w,G,k,b,O,e,N;
return g.h(function(Y){switch(Y.U){case 1:return a=g.X2(),w=xAl(q),G=g.vA(xbx),g.ml(Y,2),b={Hs:!0},g.n(Y,g.Bt(a,w,G,void 0,b),4);case 4:k=Y.V;g.xl(Y,3);break;case 2:O=g.rc(Y);if(O instanceof g.ct)throw e="GetOffline network manager error for playlist: "+O.message,Ga(e,O),Error(e);Ga("GetOffline fetch request error for playlist",O);throw Error("GetOffline fetch request error for playlist");case 3:N=nq(k);if(!k)throw Ga("Network request failed for playlist"),Error("Network request failed for playlist");
if(N!==void 0)MB(N,"playlist");else if(!k.playlists||!k.playlists.length)throw Ga("No data for playlist"),Error("No data for playlist");return Y.return(k.playlists.map(function(P){return P.offlinePlaylistData}))}})},nsJ=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK;
return g.h(function(Mm){switch(Mm.U){case 1:return g.n(Mm,qB(),2);case 2:k=Mm.V;if(!k)return Mm.return([]);b=[];if((O=G)==null?0:O.length){b=G;Mm.Gl(3);break}return g.n(Mm,yU(k,"mainPlaylistEntity"),4);case 4:b=Mm.V;case 3:if(!b.length)return Mm.return([]);e=[];N=Date.now()/1E3;Y=g.V(b);P=Y.next();case 5:if(P.done)return e.length?g.n(Mm,rDR(e),10):Mm.return([]);K=P.value;if(!K.downloadState){d=void 0;Mm.Gl(8);break}return g.n(Mm,Ri(k,K.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:d=
Mm.V;case 8:T=d;F=void 0;Q=(J=(F=K)==null?void 0:F.entityMetadata)&&J.nextAutoRefreshIntervalSeconds?Number(J.nextAutoRefreshIntervalSeconds):NaN;B=Number.isNaN(Q)?q:Q;M=L=void 0;H=((L=T)==null?0:L.lastSyncedTimestampMillis)?Number((M=T)==null?void 0:M.lastSyncedTimestampMillis)/1E3:0;D=X=void 0;z=((X=T)==null?0:X.addedTimestampMillis)?Number((D=T)==null?void 0:D.addedTimestampMillis)/1E3:0;if(w||!J||H+B<=N){Oj=[];$l=void 0;if(($l=K.videos)==null?0:$l.length)for(ey=g.V(K.videos),Nm=ey.next();!Nm.done;Nm=
ey.next())a_=Nm.value,BJ=JSON.parse(g.Ie(a_).entityId),BJ.videoId&&Oj.push(BJ.videoId);WJ="0";J&&(gy=void 0,WJ=String(Number((gy=J.offlineLastModifiedTimestampSeconds)!=null?gy:0).toFixed()));F8={playlistId:K.playlistId,videoIds:Oj,offlineLastModifiedTimestamp:WJ,autoSync:a,offlineDateAddedTimestamp:String(z.toFixed())};e.push(F8)}P=Y.next();Mm.Gl(5);break;case 10:return eK=Mm.V,Mm.return(eK)}})},Mdx=function(){var q,a,w,G,k;
return g.h(function(b){if(b.U==1)return g.n(b,qB(),2);if(b.U!=3)return(q=b.V)?g.n(b,yU(q,"refresh"),3):b.return(!1);a=b.V;if((w=a[0])==null||!w.refreshTime)return b.return(!1);G=Number(a[0].refreshTime);k=Date.now()/1E3;return b.return(isFinite(G)&&k>=G)})},S5c=function(q,a){var w,G,k;
return g.h(function(b){switch(b.U){case 1:return g.ml(b,2),g.n(b,hs6(q,a),4);case 4:return G=b.V,g.n(b,PX6(G),5);case 5:w=dbU(G);g.xl(b,3);break;case 2:k=g.rc(b),Ga("getAndProcessSmartDownloadsResponse request or processing error",k);case 3:return b.return(w)}})},fHJ=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK;
return g.h(function(Mm){switch(Mm.U){case 1:return g.n(Mm,qB(),2);case 2:k=Mm.V;if(!k)return Mm.return([]);b=[];if((O=G)==null?0:O.length){b=G;Mm.Gl(3);break}return g.n(Mm,yU(k,"musicPlaylist"),4);case 4:b=Mm.V;case 3:if(!b.length)return Mm.return([]);e=[];N=Date.now()/1E3;Y=g.V(b);P=Y.next();case 5:if(P.done)return e.length?g.n(Mm,rDR(e),10):Mm.return([]);K=P.value;d=void 0;F=(T=(d=K)==null?void 0:d.entityMetadata)&&T.nextAutoRefreshIntervalSeconds?Number(T.nextAutoRefreshIntervalSeconds):NaN;J=
Number.isNaN(F)?q:F;B=Q=0;L="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!K.downloadMetadata){Mm.Gl(8);break}return g.n(Mm,Ri(k,K.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:M=Mm.V,X=H=void 0,Q=Number((X=(H=M)==null?void 0:H.addedTimestampMillis)!=null?X:"0")/1E3,z=D=void 0,B=Number((z=(D=M)==null?void 0:D.lastModifiedTimestampMillis)!=null?z:"0")/1E3,$l=Oj=void 0,L=($l=(Oj=M)==null?void 0:Oj.syncState)!=null?$l:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:ey=void 0;if(w||L!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!T||Number((ey=T.lastSyncedTimestampSeconds)!=null?ey:0)+J<=N){Nm=[];a_=void 0;if((a_=K.tracks)==null?0:a_.length)for(BJ=g.V(K.tracks),WJ=BJ.next();!WJ.done;WJ=BJ.next())gy=WJ.value,Nm.push(g.Ie(gy).entityId);F8={playlistId:K.playlistId,videoIds:Nm,offlineLastModifiedTimestamp:String(B.toFixed()),autoSync:a,offlineDateAddedTimestamp:String(Q.toFixed())};e.push(F8)}P=Y.next();Mm.Gl(5);break;case 10:return eK=Mm.V,Mm.return(eK)}})},hs6=function(q,a){var w,G,k,b,O,e,N,Y,P,K;
return g.h(function(d){switch(d.U){case 1:return w=g.X2(),g.n(d,qB(),2);case 2:G=d.V;if(!G){d.Gl(3);break}return g.n(d,SZ6(G),4);case 4:k=d.V;case 3:var T=k;b={context:g.IA(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:q},offlineClientState:T,clientStateRequestData:{preferredFormatType:a}}}};O=g.vA(HJR);g.ml(d,5);N={Hs:!0};return g.n(d,g.Bt(w,b,O,void 0,N),7);case 7:e=d.V;g.xl(d,6);break;case 5:Y=g.rc(d);if(Y instanceof g.ct)throw P=
"DPS network manager error for smart downloads: "+Y.message,Ga(P,Y),Error(P);Ga("DPS fetch request error for smart downloads",Y);throw Error("DPS fetch request error for smart downloads");case 6:K=nq(e);if(e)K!==void 0&&MB(K,"smart downloads");else throw Ga("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return d.return(e)}})},pve=function(q,a){var w,G,k,b,O,e,N,Y;
return g.h(function(P){switch(P.U){case 1:return w=g.X2(),G={context:g.IA(),videoPlaybackPositionEntities:q,lastSyncTimestampUsec:a},k=g.vA(cD6),g.ml(P,2),O={Hs:!0},g.n(P,g.Bt(w,G,k,void 0,O),4);case 4:b=P.V;g.xl(P,3);break;case 2:e=g.rc(P);if(e instanceof g.ct)throw N="VPPS network manager error: "+e.message,Ga(N,e),Error(N);Ga("VPPS fetch request error",e);throw Error("VPPS fetch request error");case 3:Y=nq(b);if(b)Y!==void 0&&MB(Y,"position sync");else throw Ga("Network request failed for position sync"),
Error("Network request failed for position sync");return P.return(b)}})},XvI=function(q,a,w){var G,k,b,O,e,N,Y,P;
return g.h(function(K){switch(K.U){case 1:G=g.X2();var d=w.refreshData,T=w.isEnqueuedForExpiredStreamUrlRefetch,F=w.L4,J=w.offlineSourceData,Q=w.mediaCapabilities,B={entityKey:q};d&&(B.refreshData=d);T&&(B.isExpiredStreamUrlRefetch=T);F&&(B.downloadParameters=F);J&&(B.offlineSourceData=J);d={context:g.ET(a),signatureTimestamp:20305,videos:[B]};Q&&(d.mediaCapabilities=Q);k=d;b=g.vA(UbU);g.ml(K,2);e={Hs:!0};return g.n(K,g.Bt(G,k,b,void 0,e),4);case 4:O=K.V;g.xl(K,3);break;case 2:N=g.rc(K);if(N instanceof
g.ct)throw Y="GetPDE network manager error: "+N.message,Ga(Y,N),Error(Y);Ga("GetPDE fetch request error",N);throw Error("GetPDE fetch request error");case 3:P=nq(O);if(O)P!==void 0&&MB(P,"PDE");else throw Ga("Network request failed for PDE"),Error("Network request failed for PDE");return K.return(O)}})},nq=function(q){var a;
return(a=q.errorMetadata)==null?void 0:a.status},MB=function(q,a){a=a?" for "+a:"";
if(q===0)throw q="Empty response body"+a,Ga(q),Error(q);q="Response with error"+a;Ga(q);throw Error(q);},rDR=function(q){var a,w,G,k,b,O,e,N;
return g.h(function(Y){switch(Y.U){case 1:return a=g.X2(),w=Lne(q),G=g.vA(j1l),g.ml(Y,2),b={Hs:!0},g.n(Y,g.Bt(a,w,G,void 0,b),4);case 4:k=Y.V;g.xl(Y,3);break;case 2:O=g.rc(Y);if(O instanceof g.ct)throw e="offlinePlaylistSyncCheck network manager error: "+O.message,Ga(e,O),Error(e);Ga("offlinePlaylistSyncCheck fetch request error",O);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:N=nq(k);if(!k)throw Ga("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(N!==void 0)MB(N,"playlist sync");else if(!k.offlinePlaylistSyncCheckDatas||!k.offlinePlaylistSyncCheckDatas.length)throw Ga("No data for playlist sync"),Error("No data for playlist sync");return Y.return(k.offlinePlaylistSyncCheckDatas.map(function(P){return P.offlinePlaylistSyncCheckData}))}})},hC=function(q){this.V=q},osl=function(q,a){var w,G,k,b,O,e;
return g.h(function(N){switch(N.U){case 1:w=new Map,G=g.V(a),k=G.next();case 2:if(k.done){N.Gl(4);break}b=k.value;O=w;e=O.set;return g.n(N,q.U(b),5);case 5:e.call(O,b,N.V);k=G.next();N.Gl(2);break;case 4:return N.return(w)}})},Sq=function(q,a,w,G,k,b){a=g.uH(a,w);
G=Object.assign({},b,{priority:G,retryScheduleIntervalsInSeconds:k});return{actionType:q,entityKey:a,actionMetadata:G}},fq=function(q,a,w,G,k,b){this.status=q;
this.V=a;this.Y=w;this.U=G;this.W=k;this.downloadState=b},IHl=function(q,a,w){this.V=q;
this.V7=a;this.W=w},vsx=function(q,a){var w,G,k,b,O,e,N,Y,P;
return g.h(function(K){switch(K.U){case 1:return w=a.entityKey,k=(G=g.I(a.actionMetadata,HM))==null?void 0:G.isEnqueuedForExpiredStreamUrlRefetch,g.ml(K,2),b=void 0,g.n(K,u0w(q,a),4);case 4:b=K.V;g.ml(K,5);var d=(d=g.I(a.actionMetadata,HM))?{maximumDownloadQuality:d.maximumDownloadQuality}:void 0;return g.n(K,XvI(w,q.V7,{isEnqueuedForExpiredStreamUrlRefetch:k,L4:d,offlineSourceData:b}),7);case 7:O=K.V;g.xl(K,6,2);break;case 5:return g.rc(K,2),e=NB(a)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",Ga("PDE handleAdd error"),K.return(cM(a,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",e,"DOWNLOAD_STATE_FAILED"));case 6:return g.n(K,tdx(q,O,a),8);case 8:return K.return(cM(a,!0,O.orchestrationActions));case 2:return N=g.rc(K),Y="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",P="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",N instanceof g.eI&&N.type==="QUOTA_EXCEEDED"&&(Y="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
P="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Ga("PDE handleAdd error"),K.return(cM(a,!1,void 0,Y,P,"DOWNLOAD_STATE_FAILED"))}})},WY8=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l;
return g.h(function(ey){switch(ey.U){case 1:return w=a.entityKey,G=g.Ie(w).entityId,g.n(ey,Wu(q.V,{mode:"readonly",EA:!0},function(Nm){var a_=oi(Nm,w,"playbackData"),BJ=oi(Nm,g.uH(G,"offlineVideoPolicy"),"offlineVideoPolicy");Nm=oi(Nm,g.uH(G,"transfer"),"transfer");return g.$7.all([a_,BJ,Nm])}),2);
case 2:k=ey.V;b=g.V(k);O=b.next().value;e=b.next().value;N=b.next().value;Y=O;P=e;K=N;if(!Y||!P)return ey.return(cM(a,!0));d=[];J=((F=Y)==null?0:F.playerResponseJson)?JSON.parse(Y.playerResponseJson):null;if(!(K&&J&&q.V7.T("html5_refresh_deprecated_downloads"))){ey.Gl(3);break}T=zs7(q,J,K);return g.n(ey,iJB(q,K),4);case 4:d=ey.V;case 3:Q={lastPlayerResponseTimestampSeconds:Y.playerResponseTimestamp,offlineToken:P.offlineToken,formatIds:d};B={};if((L=K)==null?0:L.maximumDownloadQuality)B.maximumDownloadQuality=
K.maximumDownloadQuality;g.ml(ey,5);M=void 0;return g.n(ey,u0w(q,a),7);case 7:return M=ey.V,g.ml(ey,8),g.n(ey,XvI(w,q.V7,{refreshData:Q,L4:B,offlineSourceData:M,mediaCapabilities:T}),10);case 10:H=ey.V;g.xl(ey,9,5);break;case 8:return g.rc(ey,5),X=NB(a)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",Ga("PDE handleRefresh error"),ey.return(cM(a,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",X,
"DOWNLOAD_STATE_FAILED"));case 9:return g.n(ey,tdx(q,H,a),11);case 11:return ey.return(cM(a,!0,H.orchestrationActions));case 5:return D=g.rc(ey),z="PDE handleRefresh error",D instanceof Error&&(z="PDE handleRefresh error: "+D.message),Oj="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",$l="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",D instanceof g.eI&&D.type==="QUOTA_EXCEEDED"&&(Oj="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",$l="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
Ga(z),ey.return(cM(a,!1,void 0,Oj,$l,"DOWNLOAD_STATE_FAILED"))}})},u0w=function(q,a){var w,G,k,b;
return g.h(function(O){if(O.U==1)return w=g.Ie(a.entityKey).entityId,G=g.uH(w,"videoDownloadContextEntity"),g.n(O,Ri(q.V,G,"videoDownloadContextEntity"),2);k=O.V;return(b=k)!=null&&b.offlineModeType?O.return({offlineModeType:k.offlineModeType}):O.return(void 0)})},tdx=function(q,a,w){var G,k,b,O,e;
return g.h(function(N){if(N.U==1){if(!a.frameworkUpdates||!g.I(a.frameworkUpdates,Q3))return N.return();if(!(g.I(a.frameworkUpdates,Q3).mutations&&g.I(a.frameworkUpdates,Q3).mutations.length>0&&g.I(a.frameworkUpdates,Q3).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return N.Gl(2);G=g.Ie(g.I(a.frameworkUpdates,Q3).mutations[0].entityKey).entityId;return g.n(N,AC(q.V,G),3)}if(N.U!=2){k=N.V;b=g.I(w.actionMetadata,HM);if(e=(O=b)==null?void 0:O.playlistId)k.playlistId=e;k.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.Zg(q.V7)?g.n(N,mg(G,q.V,w,q.W,k),2):g.BA(q.V7)?g.n(N,x2(G,q.V,w,q.W),2):N.Gl(2)}return g.n(N,FnR(g.I(a.frameworkUpdates,Q3)),0)})},cM=function(q,a,w,G,k,b){return new fq(a?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",NB(q),w,G,k,b)},zs7=function(q,a,w){a=wv8(q.V7,w.cotn,a);
w=g.nc(a);return g.Jec(a,w,q.V7)},iJB=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d;
return g.h(function(T){if(T.U==1)return w=[],g.n(T,Wu(q.V,{mode:"readonly",EA:!0},function(F){var J=[],Q=a.offlineVideoStreams;if(Q){Q=g.V(Q);for(var B=Q.next();!B.done;B=Q.next())J.push(oi(F,B.value,"offlineVideoStreams"))}return g.$7.all(J)}),2);
if(G=T.V)for(k=g.V(G),b=k.next();!b.done;b=k.next())if(O=b.value,e=void 0,(e=O)==null?0:e.streamsProgress)for(N=O.streamsProgress,Y=0;Y<N.length;Y++)P=N[Y],K=JSON.parse(P.formatStreamBytes),d={itag:K.itag,lmt:K.lastModified,xtags:K.xtags},w.push(d);return T.return(w)})},Dbx=function(q,a){this.V=q;
this.V7=a},RsV=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T;
return g.h(function(F){switch(F.U){case 1:return w=NB(a),g.n(F,yU(q.V,"videoPlaybackPositionEntity"),2);case 2:G=F.V;if(G.length===0)return F.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));g.ml(F,3);return g.n(F,UG.getInstance(),5);case 5:k=F.V;if(!k)throw Error("prefStorage is undefined");return g.n(F,k.get("psi"),6);case 6:return b=F.V,N=(e=(O=b)==null?void 0:O.HG)!=null?e:"0",g.n(F,pve(G,N),7);case 7:return Y=F.V,P={isPaused:Y.watchHistoryPaused,HG:Y.syncTimestampUsec},g.n(F,k.set("psi",
P),8);case 8:if(P.isPaused){F.Gl(9);break}K=g.I(Y.frameworkUpdates,Q3);if(!Y.frameworkUpdates||!K){F.Gl(9);break}return g.n(F,FnR(K),9);case 9:g.xl(F,4);break;case 3:return d=g.rc(F),T="PPE handleRefresh error: "+(d instanceof Error?d.message:"unknown error"),Ga(T),F.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return F.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},q8B=function(q,a){var w,G,k,b,O,e,N,Y;
return g.h(function(P){switch(P.U){case 1:return w=NB(a),G=g.Ie(a.entityKey).entityId,g.ml(P,2),g.n(P,UG.getInstance(),4);case 4:k=P.V;if(!k)throw Error("prefStorage is undefined");return g.n(P,k.get("psi"),5);case 5:b=P.V;O=g.I(a.actionMetadata,yDw);if(((e=b)==null?void 0:e.isPaused)!==!1||(N=O)==null||!N.lastPlaybackPositionSeconds){P.Gl(6);break}Y={key:g.uH(G,"videoPlaybackPositionEntity"),videoId:G,lastPlaybackPositionSeconds:O.lastPlaybackPositionSeconds};return g.n(P,Dr(q.V,Y,"videoPlaybackPositionEntity"),
6);case 6:g.xl(P,3);break;case 2:return g.rc(P),P.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return P.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w))}})},gXK=function(q,a){var w,G,k;
return g.h(function(b){switch(b.U){case 1:w=NB(a);g.ml(b,2);G=g.Ie(a.entityKey).entityId;if(G==="!*$_ALL_ENTITIES_!*$")return g.n(b,Knw(q.V),5);k=g.uH(G,"videoPlaybackPositionEntity");return g.n(b,PlJ(q.V,k),5);case 5:g.xl(b,3);break;case 2:return g.rc(b),b.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return b.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},aWy=function(q,a){this.api=q;
this.V=a;this.logger=new g.Zw("woffle");this.U=!1;this.qh={Zx:this.Zx};this.logger.debug("Initialized OfflineMediaManager")},wBV=function(q){return g.h(function(a){return a.return(QoI(q))})},GMw=function(q){var a;
return g.h(function(w){if(w.U==1)return g.n(w,g.vZN(q),2);a=w.V;return w.return(a.filter(function(G){return!!G.url}).map(function(G){return G.url}))})},pq=function(q,a){var w=g.gM(a);
if(w===1||w===0)return Promise.resolve();(w=kMI(q,a))&&w.stopVideo();q.W=0;return wBV(a)},UW=function(q,a,w,G){w=w===void 0?!1:w;
G=G===void 0?!0:G;var k=typeof a==="string"?a:a.videoDetails.videoId;g.gM(k)===2&&((a=kMI(q,k))?a.stopVideo():q.logger.info(function(){return"Corresponding player for "+k+" not found. Pausing anyway"}),g.ap(k,2),q.W=2,w?baU(q.V):G&&Oaw(q.V))},kMI=function(q,a){var w;
return((w=q.player)==null?void 0:w.getVideoData().videoId)===a?q.player:null},lWw=function(q,a,w){a.getPlayerResponse();
g.ap(a.videoId,2);q.W=2;q.U=!1;var G;(G=q.player)==null||G.dispose();q.player=q.api.hx(a);a={};q.player.Ie((a.localmediachange=q.PZ,a.signatureexpired=q.Y8,a.statechange=q.YAh,a),q);q.T("html5_generate_content_po_token")&&q.player.Ez();var k=q.Zx(w);q.player.qN(g.Av(k,k,!0,"m"),!1);q.logger.debug(function(){return"Starting headless playback with quality: "+k});
q.player.TH(!1)},eT8=function(q,a){this.V=q;
this.V7=a},Y8c=function(q,a){var w,G;
return g.h(function(k){switch(k.U){case 1:return w=NB(a),g.n(k,Ri(q.V,a.entityKey,"transfer"),2);case 2:if(G=k.V)return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));g.ml(k,3);return g.n(k,NUK(q,a),5);case 5:g.xl(k,4);break;case 3:return g.rc(k),k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},P9K=function(q,a){var w,G;
return g.h(function(k){switch(k.U){case 1:return w=NB(a),g.n(k,Ri(q.V,a.entityKey,"transfer"),2);case 2:G=k.V;if(!G||G.transferState!=="TRANSFER_STATE_COMPLETE")return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));g.ml(k,3);return g.n(k,NUK(q,a,!0),5);case 5:g.xl(k,4);break;case 3:return g.rc(k),k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w))}})},Kac=function(q,a){var w,G,k,b,O,e,N,Y,P,K;
return g.h(function(d){switch(d.U){case 1:return w=NB(a),G=g.Ie(a.entityKey).entityId,g.n(d,Wu(q.V,{mode:"readonly",EA:!0},function(T){var F=oi(T,a.entityKey,"transfer");T=oi(T,g.uH(G,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.$7.all([F,T])}),2);
case 2:k=d.V;b=g.V(k);O=b.next().value;e=b.next().value;N=O;Y=e;if(!N||N.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return d.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));g.ml(d,3);N.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.n(d,Dr(q.V,N,"transfer"),5);case 5:P=g.Ie(N.key).entityId;DA7({videoId:P,C3:N,offlineModeType:(K=Y)==null?void 0:K.offlineModeType});g.xl(d,4);break;case 3:return g.rc(d),d.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",
w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return d.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w))}})},NUK=function(q,a,w){w=w===void 0?!1:w;
var G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B;return g.h(function(L){switch(L.U){case 1:return G=g.I(a.actionMetadata,dGw),k=g.Ie(a.entityKey).entityId,b=g.uH(k,"downloadStatusEntity"),g.n(L,Wu(q.V,{mode:"readonly",EA:!0},function(M){var H=oi(M,b,"downloadStatusEntity");M=oi(M,g.uH(k,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.$7.all([H,M])}),2);
case 2:return O=L.V,e=g.V(O),N=e.next().value,Y=e.next().value,P=N,K=Y,d="TRANSFER_STATE_TRANSFER_IN_QUEUE",((T=P)==null?void 0:T.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(d="TRANSFER_STATE_PAUSED_BY_USER"),Q={key:a.entityKey,transferState:d,cotn:g.K5(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(F=G)==null?void 0:F.maximumDownloadQuality,preferredAudioTrack:(J=G)==null?void 0:J.preferredAudioTrack,transferRetryCount:0,isRefresh:w,hasLoggedFirstStarted:!1},g.n(L,Wu(q.V,
{mode:"readwrite",EA:!0},function(M){var H=[];w&&H.push(vu(M,g.uH(k,"offlineVideoStreams")));H.push(tJ(M,Q,"transfer"));return g.$7.all(H)}),3);
case 3:if(!w){L.Gl(4);break}return g.n(L,wBV(k),4);case 4:i1l({videoId:k,C3:Q,offlineModeType:(B=K)==null?void 0:B.offlineModeType}),g.Jm(L)}})},$G7=function(q,a,w,G){if(!q.action.entityKey)throw Error("entityKey is missing.");
var k=g.Ie(q.action.entityKey);k={entityType:k.pM,entityId:k.entityId,offlineOrchestrationActionType:q.action.actionType,orchestrationAction:{orchestrationActionId:q.actionId}};a&&(k.offlineOrchestrationActionResult=a.status,k.isRetryable=w?!1:a.V,a.W&&(k.offlineOrchestrationFailureReason=TUK(a.W,k.isRetryable)));var b,O;if((b=q.action.actionMetadata)==null?0:(O=b.offlineLoggingData)==null?0:O.offlineModeType)k.offlineModeType=q.action.actionMetadata.offlineLoggingData.offlineModeType;G&&(k.additionalOrchestrationActions=
G.map(function(e){return{orchestrationActionId:e.actionId}}));
return k},TUK=function(q,a){return q!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||a?q==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&a?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":q:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},shR=function(q,a){var w={offlineOrchestrationContext:$G7(q)};
a=Mt7(a,w);hCV(n8c(),a,q.rootActionId)},FaI=function(q,a,w,G){G=G===void 0?[]:G;
a={offlineOrchestrationContext:$G7(q,a,w,G)};a=Mt7(3,a);hCV(n8c(),a,q.rootActionId)},C9V=function(){this.actions=[]},Zay=function(q,a){a=g.V(a);
for(var w=a.next();!w.done;w=a.next())w=w.value,shR(w,1),q.actions.push(w);q.actions.sort(q.V)},EX8=function(q,a){if(a)for(var w=0;w<q.actions.length;w++)if(a==="!*$_ALL_ENTITIES_!*$"&&q.actions[w].actionId!==a||a!=="!*$_ALL_ENTITIES_!*$"&&q.actions[w].rootActionId===a&&q.actions[w].actionId!==a)q.actions.splice(w,1),w--},VLI=function(q,a){q=g.V(q.actions);
for(var w=q.next();!w.done;w=q.next())if(w.value.actionId===a)return!0;return!1},X6=function(q,a,w,G,k){g.c.call(this);
var b=this;this.U=q;this.y7=a;this.F9=w;this.X=G;this.V7=k;this.V=new C9V;this.L=new g.c0;this.W=new g.o1(function(){b.retry()});
this.S=NaN;this.D=!1;this.qh={MjT:function(){return b.V},
NW:function(){return b.L},
bm9:function(){return b.W},
retry:function(){return b.retry()}};
g.p(this,this.W);this.J=this.U.observe(this.UK.bind(this))},Qh6=function(q,a,w,G,k){var b;
return g.h(function(O){if(O.U==1)return b=new X6(q,a,w,G,k),g.n(O,JXU(b),2);mGR(b);return O.return(b)})},mGR=function(q){var a=q.V.actions[0];
return q.Y?((a==null?void 0:a.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&q.Y[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(q.D=!0),Promise.resolve()):AXV(q)},AXV=function(q){var a,w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B;
return g.h(function(L){switch(L.U){case 1:if(q.Y)throw Error("Already processing an action");if(q.t2())return L.return();a=q.V.actions.shift();v8R(q.F9,!a);if(a===void 0)return L.return();a.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&a.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&EX8(q.V,a.actionId);w="";a.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&a.rootActionId===a.actionId&&(w=a.actionId);G=[a];q.Y=G;if(k=q.y7[a.entityType]){L.Gl(2);break}q.Y=
void 0;return g.n(L,AXV(q),3);case 3:return L.return();case 2:b=g.V(G);for(O=b.next();!O.done;O=b.next())e=O.value,shR(e,2);g.ml(L,4,5);return g.n(L,osl(k,G.map(function(M){return M.action})),7);
case 7:N=L.V,Y=g.V(G),P=Y.next();case 8:if(P.done){L.Gl(10);break}K=P.value;d=N.get(K.action);return g.n(L,xGx(q,K,d),9);case 9:P=Y.next();L.Gl(8);break;case 10:EX8(q.V,w);case 5:g.Sy(L);q.Y=void 0;g.HJ(L,6);break;case 4:return T=g.rc(L),Ga("Orchestration error",T),g.ml(L,12),g.n(L,LaV(q,G),14);case 14:g.xl(L,5);break;case 12:F=g.rc(L);Ga("Orchestration retry error",F);J=g.V(G);for(Q=J.next();!Q.done;Q=J.next())B=Q.value,B.retryScheduleIndex<3&&Zay(q.V,[B]);L.Gl(5);break;case 6:return g.n(L,AXV(q),
0)}})},xGx=function(q,a,w){var G,k,b,O,e,N,Y,P,K,d,T,F;
return g.h(function(J){switch(J.U){case 1:G=a.retryScheduleIndex+2===3;if(w.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){J.Gl(2);break}if(w.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){J.Gl(0);break}FaI(a,w,G);if(w.V&&a.retryScheduleIndex+1<3)return g.n(J,LaV(q,[a]),0);b=((k=w)==null?0:k.U)?w.U:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";O={entityKey:a.action.entityKey,failureReason:b};e=void 0;g.Zg(q.V7)?e="mainVideoDownloadStateEntity":g.BA(q.V7)&&(e="musicTrackDownloadMetadataEntity");
if(!e||!w.downloadState){J.Gl(7);break}N=g.Ie(a.action.entityKey).entityId;return g.n(J,Ta(N,e,q.U,w.downloadState),7);case 7:bC(q.X,O);if(w.downloadState==="DOWNLOAD_STATE_FAILED"&&q.V7.T("html5_auto_retry_failed_pde_actions")){J.Gl(0);break}Ga("Orchestration result is not retryable, deleting action");return g.n(J,PlJ(q.U,EW(a).key),0);case 2:Y=void 0;try{Y=(P=w.Y)==null?void 0:P.map(function(Q){return q.createAction(Q,a)})}catch(Q){return FaI(a,w,G),K={entityKey:a.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},bC(q.X,K),Ga("Orchestration subactions creation error",Q),J.return()}FaI(a,w,G,Y);if(!Y){J.Gl(12);break}d=Y.map(function(Q){return EW(Q)});
T=0;case 13:if(!(T<Y.length)||q.D){J.Gl(15);break}return g.n(J,Wu(q.U,{mode:"readwrite",EA:!0},function(Q){var B=[];B.push(aXB(Q,d.slice(T,T+10),"offlineOrchestrationActionWrapperEntity"));return g.$7.all(B)}),16);
case 16:T+=10;J.Gl(13);break;case 15:if(q.D)return q.D=!1,J.return();case 12:return F=EW(a),g.n(J,PlJ(q.U,F.key),17);case 17:shR(a,4),g.Jm(J)}})},MLJ=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T;
return g.h(function(F){w=[];G=Infinity;k=4E3;b=g.V(a);for(O=b.next();!O.done;O=b.next())e=O.value,N=Number(e.enqueueTimeSec),Y=BUy(N),P=e.retryScheduleIndex,K=P!=null&&P>0,Y>0&&K?(G=Math.min(G,N),k=Math.min(Y,k)):w.push(e);isFinite(G)&&(!q.W.isActive()||G<q.S)&&(q.S=G,q.W.start(k));q.L.GA()||(d=w.length,w=w.filter(function(J){var Q;J=((Q=J.actionProto)==null?void 0:Q.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!rXB.includes(J)}),T=w.length<d,!q.W.isActive()&&T&&q.W.start(1));
w.length>0&&nXB(q,w);return g.n(F,mGR(q),0)})},S8e=function(q){var a,w,G,k,b,O,e;
return g.h(function(N){if(N.U==1)return g.n(N,hTU(q),2);a=N.V;w=[];G=g.V(a);for(k=G.next();!k.done;k=G.next())b=k.value,O=g.Ie(b.key),e=O.entityId,VLI(q.V,e)||w.push(b);return g.n(N,MLJ(q,w),0)})},BUy=function(q){q=q*1E3-Date.now();
return q>4E3?4E3:q},LaV=function(q,a){var w,G,k;
return g.h(function(b){w=g.V(a);for(G=w.next();!G.done;G=w.next()){k=G.value;var O=void 0,e=void 0,N=((e=k.action)==null?void 0:(O=e.actionMetadata)==null?void 0:O.retryScheduleIntervalsInSeconds)||[1,2,4];O=1;k.retryScheduleIndex<N.length&&(O=N[k.retryScheduleIndex]);k.V=O*1E3+Date.now();k.retryScheduleIndex++}return g.n(b,fWI(q,a),0)})},JXU=function(q){var a;
return g.h(function(w){if(w.U==1)return g.n(w,yU(q.U,"offlineOrchestrationActionWrapperEntity"),2);a=w.V;return g.n(w,MLJ(q,a),0)})},nXB=function(q,a){a.length!==0&&a.forEach(function(w){w=ZC(w);
w.retryScheduleIndex<3&&Zay(q.V,[w])})},hTU=function(q,a){var w;
return g.h(function(G){if(G.U==1)return g.n(G,yU(q.U,"offlineOrchestrationActionWrapperEntity",a),2);w=G.V;return G.return(w.filter(Cl7))})},fWI=function(q,a){if(a.length===0)return Promise.resolve([]);
a=a.map(function(w){return EW(w)});
return YZ7(q.U,a)},HaV=function(q){this.MB=q;
this.V=void 0},cXB=function(q,a){var w,G,k,b;
return g.h(function(O){w=a.videoId;G=!0;if(a.captionTracks.length)k=i7B(a),q.V=new g.xq(q.MB,a,k);else if(a.M9)b=g.gRf(a),q.V=new g.B1(q.MB,a.M9,w,b,a.UM,a.eventId),G=a.UM;else return O.return();return O.return(new Promise(function(e){var N;(N=q.V)==null||N.Oi({lM:function(){return g.h(function(Y){if(Y.U==1)return g.n(Y,q.lM(w,G),2);e();g.Jm(Y)})},
Hd:function(){}})}))})},pBV=function(q){var a;
return g.h(function(w){if(w.U==1)return g.n(w,mAU(q),2);a=w.V;return w.return(!!a&&a.length>0)})},jq=function(q){g.c.call(this);
this.V=q;this.U=this.V.observe(this.W.bind(this))},UGB=function(q,a){var w,G,k,b,O,e,N;
return g.h(function(Y){switch(Y.U){case 1:if(a.length===0)return Y.return([]);w=a.map(function(P){return g.uH(P,"transfer")});
return g.n(Y,yU(q.V,"transfer",w),2);case 2:G=Y.V;k=G.filter(Cl7).map(function(P){return g.Ie(P.key).entityId});
b=a.filter(function(P){return k.indexOf(P)===-1});
if(b.length===0)return Y.return([]);O=g.V(b);e=O.next();case 3:if(e.done){Y.Gl(5);break}N=e.value;return g.n(Y,wBV(N),4);case 4:e=O.next();Y.Gl(3);break;case 5:return Y.return(b)}})},oX8=function(q,a,w,G,k,b){var O,e,N;
return g.h(function(Y){O="STREAM_TYPE_UNKNOWN";w.video&&w.audio?(O="STREAM_TYPE_AUDIO_AND_VIDEO",Ga("unexpected stream type")):w.video&&!w.audio?O="STREAM_TYPE_VIDEO":!w.video&&w.audio&&(O="STREAM_TYPE_AUDIO");e=g.uH(a,"offlineVideoStreams");N={numBytesDownloaded:k.toFixed(),numTotalBytes:b.toFixed(),streamType:O,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(G),itag:O==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(w.itag):void 0};return g.n(Y,Wu(q,{mode:"readwrite",EA:!0},
function(P){var K=oi(P,e,"offlineVideoStreams"),d=oi(P,g.uH(a,"transfer"),"transfer");return g.$7.all([K,d]).then(function(T){T=g.V(T);var F=T.next().value;T=T.next().value;if(!T)return vu(P,e).then(function(){});
var J=XB6(F);F=jhI(F,G,N,e);var Q=tJ(P,F,"offlineVideoStreams");XB6(F)>J&&(T.lastProgressTimeMs=Date.now().toString());J=[Q];T.offlineVideoStreams||(T.offlineVideoStreams=[]);T.offlineVideoStreams.indexOf(e)===-1&&(T.offlineVideoStreams.push(e),J.push(tJ(P,T,"transfer")));return g.$7.all(J)})}),0)})},IW7=function(q,a){var w,G,k,b,O;
return g.h(function(e){if(e.U==1)return w=g.uH(a,"offlineVideoStreams"),g.n(e,Ri(q,w,"offlineVideoStreams"),2);G=e.V;if(!G||!G.streamsProgress)return e.return();k=g.V(G.streamsProgress);for(b=k.next();!b.done;b=k.next())O=b.value,O.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",O.numTotalBytes!==O.numBytesDownloaded&&(O.numBytesDownloaded=O.numTotalBytes);return g.n(e,Dr(q,G,"offlineVideoStreams"),0)})},jhI=function(q,a,w,G){if(q&&q.streamsProgress){G=q;
a:{a=a.itag+";"+a.xtags;for(var k=q.streamsProgress,b=0;b<k.length;b++){var O=JSON.parse(k[b].formatStreamBytes);if(O.itag+";"+O.xtags===a){k[b]=w;w=k;break a}}k.push(w);w=k}G.streamsProgress=w}else q={key:G,streamsProgress:[w]};return q},XB6=function(q){if(q==null?0:q.streamsProgress){var a=0;
q=q.streamsProgress;for(var w=0;w<q.length;w++){var G=q[w];isNaN(Number(G.numBytesDownloaded))?Ga("stream progress bytes number invalid"):a+=Number(G.numBytesDownloaded)}return a}return 0},uNJ=function(q,a,w,G){g.c.call(this);
var k=this;this.U=q;this.api=a;this.le=w;this.UK=G;this.L=new g.c0;this.Y=new g.o1(function(){k.V&&k.V.transferState==="TRANSFER_STATE_TRANSFERRING"&&k.L.GA()&&((k.V.transferRetryCount||0)<3?UW(k.X,k.D,!1,!1):pq(k.X,k.D.videoDetails.videoId),k.kt("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.F9=this.f7=0;this.J=this.S=!1;this.St=g.Wo(this.api.B().experiments,"html5_transfer_processing_logs_interval");this.Tl=new g.Ee(this);this.qh={Bp7:function(){return k.Y},
DjT:function(){return k.UK},
NW:function(){return k.L}};
this.y7=this.U.observe(this.IU.bind(this));this.X=new aWy(a,this);this.A2=new HaV(a);this.jt=new jq(this.U);this.L7=this.L.listen("publicytnetworkstatus-online",this.Bg.bind(this));this.EK=this.L.listen("publicytnetworkstatus-offline",this.Cwt.bind(this));this.J=this.api.B().T("html5_less_transfer_processing_logs");g.p(this,this.Tl);this.Tl.C(a,"offlinetransferpause",this.SBT);if(g.Zg(this.api.B()))this.W="mainVideoDownloadStateEntity";else if(g.BA(this.api.B())||g.VG(this.api.B()))this.W="musicTrackDownloadMetadataEntity"},
tLV=function(q){return g.h(function(a){if(a.U==1)a=g.n(a,Vte(),2);
else{var w=q.jt;var G=g.qH();G=Object.keys(G);w=UGB(w,G);a=g.n(a,w,0)}return a})},Iy=function(q,a){a=a===void 0?!1:a;
var w;return g.h(function(G){if(G.U==1){if(q.V)throw Error("Already downloading a video");q.F9=0;q.S=!1;return g.n(G,vXx(q),2)}return G.U!=4?(w=G.V,zC6(q.le,!w),w&&q.L.GA()?a?g.n(G,new Promise(function(k){g.ee(k,1E3)}),4):G.Gl(4):(!w&&q.V&&oy(q),G.Gl(0))):g.n(G,zTx(q,w),0)})},iay=function(q){return g.h(function(a){if(a.U==1)return q.D?g.n(a,pq(q.X,q.D.videoDetails.videoId),3):a.Gl(0);
oy(q);g.Jm(a)})},Wa6=function(q,a){var w,G,k;
return g.h(function(b){switch(b.U){case 1:return g.ml(b,2),(w=!!a.captionTracks.length||!!a.M9)?g.n(b,pBV(a.videoId),4):b.return();case 4:return(G=b.V)?b.return():g.n(b,cXB(q.A2,a),5);case 5:g.xl(b,0);break;case 2:k=g.rc(b),Ga("Caption downloading error",k,a.cotn),g.Jm(b)}})},zTx=function(q,a){var w,G,k,b,O,e;
return g.h(function(N){switch(N.U){case 1:if(q.S)return N.return();q.S=!0;q.V=a;w=g.Ie(q.V.key);G=w.entityId;k=void 0;if(q.V.transferState==="TRANSFER_STATE_TRANSFERRING")return g.n(N,uC(q,G),7);if(q.V.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||q.V.transferRetryCount||q.V.hasLoggedFirstStarted){N.Gl(3);break}return g.n(N,uC(q,G),5);case 5:return k=N.V,q.V.hasLoggedFirstStarted=!0,g.n(N,DGU(q),6);case 6:Wn6({videoId:G,C3:q.V,offlineModeType:k},void 0,void 0,!0);N.Gl(3);break;case 7:k=N.V,
eq({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:G,C3:q.V,offlineModeType:k});case 3:return g.n(N,RT8(q),8);case 8:return b=null,g.ml(N,9),g.n(N,yXI(q,a),11);case 11:b=N.V;q.D=b;g.xl(N,10);break;case 9:return O=g.rc(N),Ga("error getting player response",O,a.cotn),g.n(N,q.kt("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return N.return();case 10:return e=wv8(q.api.B(),a.cotn,b),g.n(N,Wa6(q,e),13);case 13:return g.n(N,GMw(e.videoId),
14);case 14:e.g9=N.V,lWw(q.X,e,a.maximumDownloadQuality),q.Y.start(108E5),g.Jm(N)}})},vXx=function(q){var a,w;
return g.h(function(G){if(G.U==1)return g.n(G,yU(q.U,"transfer"),2);a=G.V;w=a.filter(qL6).sort(gg7);return w.length===0?G.return():G.return(w[0])})},RT8=function(q){var a,w,G;
return g.h(function(k){if(k.U==1){if(!q.V)return tC(q,"onTransferStart"),k.return();q.Y.start(108E5);return g.n(k,vM(q,"TRANSFER_STATE_TRANSFERRING"),2)}a=q.V;return(G=((w=a)==null?0:w.key)?g.Ie(a.key).entityId:"")&&q.W?g.n(k,Ta(G,q.W,q.U,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):k.Gl(0)})},baU=function(q){var a,w,G,k;
g.h(function(b){switch(b.U){case 1:if(!q.V){tC(q,"onTransferPausedByUser");b.Gl(2);break}a=q.V;q.Y.stop();return g.n(b,vM(q,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:G=((w=a)==null?0:w.key)?g.Ie(a.key).entityId:"";if(!G||!q.W){b.Gl(4);break}return g.n(b,Ta(G,q.W,q.U,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.n(b,uC(q,G),6);case 6:k=b.V,RCK({videoId:G,C3:a,offlineModeType:k});case 2:oy(q),Iy(q),g.Jm(b)}})},Oaw=function(q){var a,w,G;
g.h(function(k){if(k.U==1){if(!q.V)return tC(q,"onTransferPausedByNetwork"),k.return();q.Y.stop();return g.n(k,vM(q,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(k.U!=3)return a=q.V,(G=((w=a)==null?0:w.key)?g.Ie(a.key).entityId:"")&&q.W?g.n(k,Ta(G,q.W,q.U,"DOWNLOAD_STATE_PAUSED"),3):k.Gl(3);oy(q);g.Jm(k)})},ae8=function(q){var a,w,G,k,b;
g.h(function(O){switch(O.U){case 1:if(!q.V)return tC(q,"onTransferComplete"),O.return();a=q.V;q.Y.stop();if(!a||!q.D){O.Gl(2);break}w=wv8(q.api.B(),a.cotn,q.D);return g.n(O,Wa6(q,w),2);case 2:return g.n(O,vM(q,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:k=((G=a)==null?0:G.key)?g.Ie(a.key).entityId:"";if(!k||!q.W){O.Gl(5);break}return g.n(O,Ta(k,q.W,q.U,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.n(O,IW7(q.U,k),7);case 7:return g.n(O,uC(q,k),8);case 8:b=O.V,eq({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:k,C3:a,offlineModeType:b}),oy(q),Iy(q),g.Jm(O)}})},wnc=function(q,a,w){var G,k;
g.h(function(b){switch(b.U){case 1:if(!q.V)return tC(q,"onTransferProgress: "+a),b.return();if(q.V.transferState==="TRANSFER_STATE_TRANSFERRING"){b.Gl(2);break}return g.n(b,RT8(q),2);case 2:G=Date.now();if(!(G-q.f7>1E3)){b.Gl(4);break}q.f7=G;return g.n(b,oX8(q.U,w.videoId,w.U,w.TI,w.bytesDownloaded,w.V),5);case 5:if(q.J&&!(q.J&&G-q.F9>q.St)){b.Gl(4);break}q.F9=G;return g.n(b,uC(q,a),7);case 7:k=b.V,Wn6({videoId:a,C3:q.V,offlineModeType:k},w.bytesDownloaded,w.V);case 4:q.Y.start(108E5),g.Jm(b)}})},
Gec=function(q){var a=(q.V.transferRetryCount||0)<3;
a&&(q=q.V,q.transferRetryCount=(q.transferRetryCount||0)+1);return a},keV=function(q,a){a=a===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":a;
var w,G,k,b;return g.h(function(O){if(O.U==1)return q.V||tC(q,"setTransferToFailed: "+a),w="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",a==="TRANSFER_FAILURE_REASON_NETWORK"?w="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":a==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(w="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.n(O,vM(q,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",a),2);if(O.U!=3)return bC(q.UK,{entityKey:(G=q.V)==null?void 0:G.key,failureReason:w}),
k=q.V?g.Ie(q.V.key).entityId:"",g.n(O,uC(q,k),3);b=O.V;var e={videoId:k,C3:q.V,offlineModeType:b},N=a,Y={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};N&&(Y.transferFailureReason=N,Y.failureReason=y$x(N));eq(Y,e);g.Jm(O)})},vM=function(q,a,w,G){var k;
return g.h(function(b){if(b.U==1){if(!q.V)return tC(q,"saveTransferState: "+a),b.return();q.V.transferState=a;q.V.failureReason=G;g.ml(b,2);return g.n(b,DGU(q,function(O){return w?Ii(O,"offlineVideoStreams",q.V.offlineVideoStreams).then(function(e){for(var N=g.V(e),Y=N.next();!Y.done;Y=N.next())if((Y=Y.value)&&Y.streamsProgress){Y=g.V(Y.streamsProgress);for(var P=Y.next();!P.done;P=Y.next())P.value.streamState=w}return aXB(O,e.filter(function(K){return!!K}),"offlineVideoStreams")}):g.$7.resolve(void 0)}),
4)}if(b.U!=2)return g.xl(b,0);
k=g.rc(b);return k instanceof g.eI&&k.type==="QUOTA_EXCEEDED"?g.n(b,q.kt("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):b.Gl(0)})},DGU=function(q,a){var w;
return g.h(function(G){if(!q.V)return G.return();w=q.V;return g.n(G,Wu(q.U,{mode:"readwrite",EA:!0},function(k){var b=[tJ(k,w,"transfer")];a&&b.push(a(k));return g.$7.all(b)}),0)})},oy=function(q){q.V=void 0;
q.D=void 0;q.Y.stop()},yXI=function(q,a){var w,G,k,b,O;
return g.h(function(e){if(e.U==1)return w=g.Ie(a.key),G=w.entityId,k=g.uH(G,"playbackData"),g.n(e,Ri(q.U,k,"playbackData"),2);b=e.V;if((O=b)==null?0:O.playerResponseJson)return e.return(JSON.parse(b.playerResponseJson));throw Error("No PlayerResponse found");})},tC=function(q,a){q.api.d8("woffle",{mcte:a});
Ga("missing current transfer entity.")},uC=function(q,a){var w,G,k;
return g.h(function(b){if(b.U==1)return g.n(b,Ri(q.U,g.uH(a,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);w=b.V;return b.return((k=(G=w)==null?void 0:G.offlineModeType)!=null?k:void 0)})},qL6=function(q){return b_B[q.transferState]!==void 0},gg7=function(q,a){var w=b_B[q.transferState],G=b_B[a.transferState];
return w!==G?w-G:Number(q.enqueuedTimestampMs)-Number(a.enqueuedTimestampMs)},za=function(q,a){var w=this;
this.V7=q;this.api=a;this.L=new g.c0;this.D=new g.Y8;this.qh={X_:function(){return w.W.qh.X_()},
NW:function(){return w.L},
ps8:function(){return w.W},
VW:function(){return w.VW()},
H6:function(){return w.H6()},
v6:function(){return w.v6()},
MP:function(){return w.MP()},
Eu:function(){return w.Eu()},
Dz:function(G){return w.Dz(G)}};
this.W=new IX7(function(){return O_y(w)},function(){w.v6()},this.api.Gj(),this.api.T.bind(this.api));
this.V=new k2(this.api);uSw(this.W)},O_y=function(q){return g.h(function(a){q.api.zl("onOrchestrationBecameLeader");
return g.n(a,q.H6(),0)})},eH8=function(q){var a,w;
return g.h(function(G){if(G.U==1)return g.n(G,qB(),2);if(G.U!=3){a=G.V;if(!a)return Ga("PES is undefined"),G.return();q.U=new uNJ(a,q.api,q.W,q.V);w=q.GP(a);return g.n(G,Qh6(a,w,q.W,q.V,q.V7),3)}q.X=G.V;return g.n(G,leU(q),0)})},leU=function(q){var a;
return g.h(function(w){switch(w.U){case 1:if(!q.U)return Ga("transferManager is undefined"),w.return();if(q.U.V){w.Gl(2);break}return g.n(w,Iy(q.U),2);case 2:if(!q.V7.T("woffle_enable_main_downloads_library")){w.Gl(4);break}return g.n(w,q.N0(),4);case 4:if(!q.V7.T("html5_offline_playback_position_sync")){w.Gl(6);break}return g.n(w,q.KN(),7);case 7:return g.n(w,q.Dz(864E5),6);case 6:return g.n(w,q.refreshAllStaleEntities(43200,!0),9);case 9:return g.n(w,q.Dq(),10);case 10:if(!q.V7.T("html5_retry_downloads_for_expiration")){w.Gl(11);
break}return g.n(w,q.Eu(),11);case 11:return q.S=g.NL(function(){q.refreshAllStaleEntities(43200,!0);q.Dq()},9E5),g.uM(g.v5(),function(){return q.MP()}),g.n(w,qB(),13);
case 13:return a=w.V,g.n(w,o8V(a),14);case 14:tt6(q.W),g.Jm(w)}})},N0U=function(){var q,a,w,G,k,b;
return g.h(function(O){switch(O.U){case 1:return g.n(O,qB(),2);case 2:q=O.V;if(!q)return O.return([]);a=Date.now()/1E3;return g.n(O,yU(q,"offlineVideoPolicy"),3);case 3:w=O.V,G=g.V(w),k=G.next();case 4:if(k.done){O.Gl(6);break}b=k.value;if(!(b.expirationTimestamp&&Number(b.expirationTimestamp)<a)){O.Gl(5);break}b.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";b.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.n(O,Dr(q,b,"offlineVideoPolicy"),5);
case 5:k=G.next();O.Gl(4);break;case 6:return O.return(w.map(function(e){return e.key}))}})},iC=function(q,a,w,G,k){var b,O,e;
return g.h(function(N){if(N.U==1)return g.n(N,qB(),2);b=N.V;if(!b)return N.return([]);O=a.map(function(Y){var P=g.uH(Y,w);P={actionType:G,entityKey:P,actionMetadata:Object.assign({},GEc(),k)};G!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(P.actionMetadata.priority=0);Y=new Cq(w,Y,P);return EW(Y)});
e=YZ7(b,O);uSw(q.W);return N.return(e)})},YLx=function(q,a,w,G){var k,b,O,e,N,Y,P,K;
return g.h(function(d){switch(d.U){case 1:k=[],b=g.V(a),O=b.next();case 2:if(O.done){d.Gl(4);break}e=O.value;if(e.upToDate||w&&!e.shouldAutoSyncMetadata||!e.playlistId){d.Gl(3);break}N={};switch(G){case "mainPlaylistEntity":Y={nextAutoRefreshIntervalSeconds:e.checkInSeconds,autoSync:w};N={mainPlaylistEntityActionMetadata:Y};break;case "musicPlaylist":P={autoSync:w},N={musicPlaylistEntityActionMetadata:P}}return g.n(d,iC(q,[e.playlistId],G,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",N),6);case 6:(K=
d.V)&&k.push.apply(k,g.Tf(K));case 3:O=b.next();d.Gl(2);break;case 4:return d.return(k)}})},PxU=function(q,a){var w;
return g.h(function(G){return a.length?(w=GEc(),g.rI(w,HM,{isEnqueuedForExpiredStreamUrlRefetch:!0}),q.api.d8("qrd",{v:a.length}),G.return(iC(q,a,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",w))):G.return([])})},Kje=function(q,a,w){this.V=q;
this.V7=a;this.W=w},$X7=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L;
return g.h(function(M){switch(M.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,b=[],g.ml(M,2),g.n(M,dXI(q,k),4);case 4:b=M.V;if(!(q.V7.T("woffle_enable_main_downloads_library")&&((O=b)==null?0:O.length))){M.Gl(5);break}return g.n(M,s1y(q.V,[a.entityKey]),5);case 5:g.xl(M,3);break;case 2:return e=g.rc(M),N="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",e instanceof g.eI&&e.type==="QUOTA_EXCEEDED"?(N="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):Ga("Playlist add error"),M.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,N,Y));case 3:P=[];if(!q.V7.T("html5_offline_prevent_redownload_downloaded_video")){M.Gl(7);break}return g.n(M,aHK(q.V,"mainVideoEntity",b),8);case 8:b=M.V;case 7:if((K=b)==null?0:K.length)for(d=g.V(b),T=d.next();!T.done;T=d.next())if(F=T.value,J=F.offlineVideoData,Q=void 0,(Q=J)==null?0:Q.videoId)B=void 0,L=Number(((B=a.actionMetadata)==null?void 0:B.priority)||
0)+1,P.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",J.videoId,"mainVideoEntity",L,WM,T0K(a,J,k)));return M.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,P))}})},Fjx=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6,hl,Gf,Al,m,wc,MW,em,jK,zf,wy,as,I6,A,E,x,S,U,KK,t,y,f,fK,I_,lG,PR,hm,Am,aR,Qx,pw,LK,JM,nK,SK,xc;
return g.h(function(eX){switch(eX.U){case 1:return w=NB(a),G=a.entityKey,k=g.Ie(G).entityId,b=[],O=!1,k==="!*$_ALL_ENTITIES_!*$"?(O=!0,g.n(eX,yU(q.V,"mainPlaylistEntity"),5)):g.n(eX,Ri(q.V,G,"mainPlaylistEntity"),4);case 4:(e=eX.V)&&b.push(e);eX.Gl(3);break;case 5:b=eX.V;case 3:if((N=b)==null||!N.length)return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));Y=g.I(a.actionMetadata,sII);K=(P=Y)==null?void 0:P.nextAutoRefreshIntervalSeconds;T=(d=Y)==null?void 0:d.autoSync;F=[];Q=J=
!0;B=!1;if(!O&&T===!1){eX.Gl(6);break}g.ml(eX,7);return g.n(eX,nsJ(0,!!T,!0,b),9);case 9:F=eX.V;g.xl(eX,8);break;case 7:L=g.rc(eX);if(!(L instanceof Error&&L.message==="No data")){L instanceof Error&&L.message==="Empty response body"&&Ga(L.message);eX.Gl(8);break}return k==="!*$_ALL_ENTITIES_!*$"?g.n(eX,Y5R(q.V,a,q.W,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.n(eX,esx(k,q.V,a,q.W),8);case 8:if(!F.length||!O&&F[0].playlistId!==k)return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w));case 6:if(O){M=[];H=g.V(F);for(X=H.next();!X.done;X=H.next())D=X.value,D.upToDate||T&&!D.shouldAutoSyncMetadata||!D.playlistId||(z={nextAutoRefreshIntervalSeconds:D.checkInSeconds,autoSync:T},M.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",D.playlistId,"mainPlaylistEntity",0,WM,{mainPlaylistEntityActionMetadata:z})));return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,M))}F.length&&(Oj=F[0],B=!!Oj.upToDate,T&&(J=($l=Oj.shouldAutoSyncMetadata)!=null?$l:!0,Q=(ey=Oj.shouldAutoSyncVideos)!=
null?ey:!0,Oj.checkInSeconds&&(K=Oj.checkInSeconds)));if(B||!J)return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));Nm=[];a_=b[0];if(!a_.downloadState){BJ=void 0;eX.Gl(15);break}return g.n(eX,Ri(q.V,a_.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:BJ=eX.V;case 15:return WJ=BJ,F8=((gy=WJ)==null?0:gy.addedTimestampMillis)?String(WJ.addedTimestampMillis):void 0,g.ml(eX,17),g.n(eX,dXI(q,k,F8,K),19);case 19:Nm=eX.V;g.xl(eX,18);break;case 17:eK=g.rc(eX);if(!(eK instanceof
Error&&eK.message==="No data for playlist")){if(eK instanceof Error&&eK.message==="Empty response body for playlist")Ga(eK.message);else return Mm="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",O7="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",eK instanceof g.eI&&eK.type==="QUOTA_EXCEEDED"&&(Mm="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",O7="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,Mm,O7));
eX.Gl(18);break}return g.n(eX,esx(k,q.V,a,q.W),18);case 18:if(!Q)return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));cR=[];uV=new Map;if((lb=Nm)==null?0:lb.length)for(r=g.V(Nm),o6=r.next();!o6.done;o6=r.next())hl=o6.value,Gf=hl.offlineVideoData,Al=void 0,((Al=Gf)==null?0:Al.videoId)&&uV.set(Gf.videoId,Gf);m=new Map;wc=[];if((MW=a_)==null?0:(em=MW.videos)==null?0:em.length)for(jK=g.V(a_.videos),zf=jK.next();!zf.done;zf=jK.next())if(wy=zf.value,as=JSON.parse(g.Ie(wy).entityId),
I6=as.videoId)uV.has(I6)?(m.set(I6,uV.get(I6)),uV.delete(I6)):wc.push(I6);E=Number(((A=a.actionMetadata)==null?void 0:A.priority)||0)+1;x=g.V(uV.entries());for(S=x.next();!S.done;S=x.next())U=S.value,KK=g.V(U),t=KK.next().value,y=KK.next().value,f=t,fK=y,cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",f,"mainVideoEntity",E,WM,T0K(a,fK,k)));I_=g.V(m.entries());for(lG=I_.next();!lG.done;lG=I_.next())PR=lG.value,hm=g.V(PR),Am=hm.next().value,aR=hm.next().value,Qx=Am,pw=aR,cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
Qx,"mainVideoEntity",E,WM,T0K(a,pw,k)));LK=g.V(wc);for(JM=LK.next();!JM.done;JM=LK.next())nK=JM.value,SK={playlistId:k},xc={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:SK},cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",nK,"mainVideoEntity",0,WM,xc));return eX.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,cR))}})},CxI=function(q,a){var w,G,k,b;
return g.h(function(O){switch(O.U){case 1:return w=NB(a),g.ml(O,2),G=g.Ie(a.entityKey).entityId,G==="!*$_ALL_ENTITIES_!*$"?g.n(O,Y5R(q.V,a,q.W,(k=a.actionMetadata)==null?void 0:(b=k.offlineLoggingData)==null?void 0:b.offlineDeleteReason),5):g.n(O,esx(G,q.V,a,q.W),6);case 6:if(!q.V7.T("woffle_enable_main_downloads_library")){O.Gl(5);break}return g.n(O,FYB(q.V,a.entityKey),5);case 5:g.xl(O,3);break;case 2:return g.rc(O),O.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return O.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w))}})},dXI=function(q,a,w,G){var k,b,O,e,N,Y,P;
return g.h(function(K){switch(K.U){case 1:return g.n(K,B_B([a]),2);case 2:return k=K.V,g.n(K,Z_B(q,k[0],w,G),3);case 3:return b=K.V,O=b.mainPlaylistEntity,e=b.JS8,Y=OJc(O,(N=e)==null?void 0:N.avatar),g.ml(K,4),g.n(K,JC(Y),6);case 6:g.xl(K,5);break;case 4:P=g.rc(K),P instanceof Error&&P.message==="Failed to fetch"&&Ga(P.message);case 5:return K.return(k[0].videos)}})},Z_B=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H;
return g.h(function(X){switch(X.U){case 1:k=Date.now().toString();w||(w=k);b=a.videos;O=a.playlistId;e=[];N=[];if(b)for(Y=g.V(b),P=Y.next();!P.done;P=Y.next()){K=P.value;d=K.offlineVideoData;if(!d||!d.videoId)throw Ga("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");T=d.videoId;F={videoId:T,playlistId:O};J={id:g.uH(JSON.stringify(F),"mainPlaylistVideoEntity"),video:g.uH(T,"mainVideoEntity")};e.push(J);N.push(J.id)}B={key:g.uH(O,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:w,lastSyncedTimestampMillis:k};L={key:g.uH(O,"mainPlaylistEntity"),playlistId:O,videos:N,title:a.title,thumbnailStyleData:EgJ(a),visibility:VuJ(a),downloadState:B.key};a.channel&&(M=a.channel.offlineChannelData,Q=JKx(g.uH(O,"ytMainChannelEntity"),M),L.channelOwner=Q.id);((H=L)==null?0:H.entityMetadata)?(L.entityMetadata.offlineLastModifiedTimestampSeconds=a.lastModifiedTimestamp,G&&(L.entityMetadata.nextAutoRefreshIntervalSeconds=String(G))):L&&(L.entityMetadata={nextAutoRefreshIntervalSeconds:G?
String(G):void 0,offlineLastModifiedTimestampSeconds:a.lastModifiedTimestamp});g.ml(X,2);return g.n(X,Wu(q.V,{mode:"readwrite",EA:!0},function(D){var z=tJ(D,L,"mainPlaylistEntity"),Oj=tJ(D,B,"mainPlaylistDownloadStateEntity");z=[z,Oj];Oj=g.V(e);for(var $l=Oj.next();!$l.done;$l=Oj.next())z.push(tJ(D,$l.value,"mainPlaylistVideoEntity"));Q&&z.push(tJ(D,Q,"ytMainChannelEntity"));return g.$7.all(z)}),4);
case 4:g.xl(X,3);break;case 2:throw g.rc(X),Ga("PES failure for playlist"),Error("PES failure for playlist");case 3:return X.return({mainPlaylistEntity:L,JS8:Q,KfG:e})}})},JKx=function(q,a){return{id:q,
channelId:a.channelId,title:a.title,avatar:a.thumbnail}},EgJ=function(q){var a=[],w=q.videos;
w&&w.length>0&&a.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:w[0].offlineVideoData.thumbnail}}});if((q=q.additionalMetadadatas)&&q.length>0)for(q=g.V(q),w=q.next();!w.done;w=q.next()){var G=w.value.offlineBundleItemPlaylistData,k=void 0;w=(k=G)==null?void 0:k.style;k=void 0;G={collageThumbnail:{coverThumbnail:(k=G)==null?void 0:k.coverThumbnail}};switch(w){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":a.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:G});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":a.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:G});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":a.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:G});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":a.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:G})}}return a},VuJ=function(q){switch(q.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},T0K=function(q,a,w){a={offlineVideoData:a,
playlistId:w};if(q=g.I(q.actionMetadata,sII))a.maximumDownloadQuality=q.maximumDownloadQuality;return{mainVideoEntityActionMetadata:a}},mXJ=function(q,a,w){this.V=q;
this.V7=a;this.W=w},xXB=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F;
return g.h(function(J){switch(J.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,b=g.I(a.actionMetadata,DC),e=!((O=b)==null?0:O.playlistId),g.ml(J,2),g.n(J,QIU(q,k,void 0,(N=b)==null?void 0:N.offlineVideoData,e),4);case 4:g.xl(J,3);break;case 2:return Y=g.rc(J),P="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Y instanceof g.eI&&Y.type==="QUOTA_EXCEEDED"&&(P="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
J.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,P,K));case 3:d=1;d=Number(((T=a.actionMetadata)==null?void 0:T.priority)||0)+1;var Q=(Q=g.I(a.actionMetadata,DC))?{playbackDataActionMetadata:{maximumDownloadQuality:Q.maximumDownloadQuality}}:void 0;F=Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",k,"playbackData",d,AKy,Q);return J.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,[F]))}})},LjK=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L;
return g.h(function(M){switch(M.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,g.n(M,Ri(q.V,a.entityKey,"mainVideoEntity"),2);case 2:b=M.V;if(!b){O=void 0;M.Gl(3);break}return g.n(M,Ri(q.V,b.downloadState,"mainVideoDownloadStateEntity"),4);case 4:O=M.V;case 3:e=O;if(!b||!e)return M.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));g.ml(M,5);return g.n(M,QIU(q,k,e.addedTimestampMillis,(Y=g.I(a.actionMetadata,DC))==null?void 0:Y.offlineVideoData),7);case 7:P=1;P=Number(((K=
a.actionMetadata)==null?void 0:K.priority)||0)+1;N=Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",k,"playbackData",P,AKy);g.xl(M,6);break;case 5:d=g.rc(M);if(!(d instanceof Error&&d.message==="No data")){if(d instanceof Error&&d.message==="Empty response body")Ga(d.message);else return T="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",F="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",d instanceof g.eI&&d.type==="QUOTA_EXCEEDED"&&(T="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
F="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),M.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,T,F));M.Gl(6);break}return g.n(M,AC(q.V,k),9);case 9:J=M.V;Q=g.I(a.actionMetadata,DC);if(L=(B=Q)==null?void 0:B.playlistId)J.playlistId=L;J.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.n(M,mg(k,q.V,a,q.W,J),6);case 6:return M.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,N?[N]:void 0))}})},B0x=function(q,a){var w,G,k,b,O,e,N,Y,P,K;
return g.h(function(d){switch(d.U){case 1:return w=NB(a),g.ml(d,2),G=g.Ie(a.entityKey).entityId,G==="!*$_ALL_ENTITIES_!*$"?g.n(d,Y5R(q.V,a,q.W,(P=a.actionMetadata)==null?void 0:(K=P.offlineLoggingData)==null?void 0:K.offlineDeleteReason),5):g.n(d,AC(q.V,G),6);case 6:k=d.V;b=g.I(a.actionMetadata,DC);if(e=(O=b)==null?void 0:O.playlistId)k.playlistId=e;k.offlineDeleteReason=(N=a.actionMetadata)==null?void 0:(Y=N.offlineLoggingData)==null?void 0:Y.offlineDeleteReason;return g.n(d,mg(G,q.V,a,q.W,k),7);
case 7:if(!q.V7.T("woffle_enable_main_downloads_library")){d.Gl(5);break}return g.n(d,FYB(q.V,a.entityKey),5);case 5:g.xl(d,3);break;case 2:return g.rc(d),d.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return d.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w))}})},QIU=function(q,a,w,G,k){var b,O,e,N,Y,P;
return g.h(function(K){switch(K.U){case 1:if(b=G){K.Gl(2);break}return g.n(K,LYc([a]),3);case 3:O=K.V,b=O[0];case 2:return g.n(K,rKy(q,b,w,k),4);case 4:e=K.V;N=e.mainVideoEntity;Y=e.channelEntity;g.ml(K,5);var d=F6(N.thumbnail),T=F6(Y.avatar);return g.n(K,JC(d.concat(T)),7);case 7:g.xl(K,0);break;case 5:P=g.rc(K),P instanceof Error&&P.message==="Failed to fetch"&&Ga(P.message),g.Jm(K)}})},rKy=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d,T,F,J,Q;
return g.h(function(B){switch(B.U){case 1:w||(w=Date.now().toString());b=(k=a.channel)==null?void 0:k.offlineChannelData;O={id:g.uH(a.videoId,"ytMainChannelEntity"),channelId:b.channelId,title:b.title,avatar:b.thumbnail};e={key:g.uH(a.videoId,"mainVideoDownloadStateEntity"),playbackData:g.uH(a.videoId,"playbackData"),addedTimestampMillis:w,videoDownloadContextEntity:g.uH(a.videoId,"videoDownloadContextEntity")};N={key:g.uH(a.videoId,"videoPlaybackPositionEntity"),videoId:a.videoId,lastPlaybackPositionSeconds:"0"};
q.V7.T("html5_offline_playback_position_sync")&&(Y={playbackPosition:N.key});P=g.uH(a.videoId,"mainVideoEntity");K={key:P,videoId:a.videoId,title:a.title,thumbnail:a.thumbnail,localizedStrings:{viewCount:a.shortViewCountText},userState:Y,lengthSeconds:a.lengthSeconds?Number(a.lengthSeconds):void 0,publishedTimestampMillis:a.publishedTimestamp?(Number(a.publishedTimestamp)*1E3).toString():void 0,formattedDescription:a.description,owner:O.id,downloadState:e.key};if(!q.V7.T("woffle_enable_main_downloads_library")||
!G){B.Gl(2);break}return g.n(B,$bR(q.V,[P]),3);case 3:if(F=B.V)d=F.mainDownloadsLibraryEntity,T=F.mainDownloadsListEntity;case 2:return Q=gsU,J={key:g.uH(a.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.rI(e,Q,J),g.n(B,Wu(q.V,{mode:"readwrite",EA:!0},function(L){var M=tJ(L,O,"ytMainChannelEntity"),H=tJ(L,e,"mainVideoDownloadStateEntity"),X=tJ(L,K,"mainVideoEntity");M=[M,H,X];q.V7.T("html5_offline_playback_position_sync")&&(H=tJ(L,N,"videoPlaybackPositionEntity"),
M.push(H));d&&(H=tJ(L,d,"mainDownloadsLibraryEntity"),M.push(H));T&&(H=tJ(L,T,"mainDownloadsListEntity"),M.push(H));J&&(L=tJ(L,J,"downloadStatusEntity"),M.push(L));return g.$7.all(M)}),4);
case 4:return B.return({mainVideoEntity:K,channelEntity:O})}})},ng8=function(q,a,w){this.V=q;
this.V7=a;this.W=w},hHU=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_;
return g.h(function(BJ){switch(BJ.U){case 1:return w=NB(a),G=[],g.n(BJ,UG.getInstance(),2);case 2:k=BJ.V;if(!k){BJ.Gl(3);break}return g.n(BJ,k.get("sdois"),4);case 4:return b=BJ.V,g.n(BJ,(e=k)==null?void 0:e.get("lmqf"),5);case 5:O=BJ.V;case 3:g.ml(BJ,6);if(b===void 0)throw Error("prefStorage or opt-in state is undefined");N=[];if(b){BJ.Gl(8);break}return g.n(BJ,T_B(q.V),9);case 9:N=BJ.V,N.reverse();case 8:if(!N.length){BJ.Gl(10);break}Y=g.V(N);P=Y.next();case 11:if(P.done){BJ.Gl(10);break}K=P.value;
if(!K){BJ.Gl(12);break}d=g.Ie(K).entityId;return g.n(BJ,AC(q.V,d),14);case 14:return T=BJ.V,T.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.n(BJ,mg(d,q.V,{entityKey:K,actionType:a.actionType},q.W,T),12);case 12:P=Y.next();BJ.Gl(11);break;case 10:return g.n(BJ,hs6(b,(F=O)!=null?F:"SD"),16);case 16:return J=BJ.V,g.n(BJ,PX6(J),17);case 17:Q=dbU(J);if(!q.V7.T("woffle_enable_main_downloads_library")){BJ.Gl(18);break}if(b){BJ.Gl(19);break}return g.n(BJ,FYB(q.V,g.H_),19);case 19:return g.n(BJ,
s1y(q.V,[g.H_]),18);case 18:if((B=Q)==null?0:B.length)for(L=g.V(Q),M=L.next();!M.done;M=L.next())if(X=H=M.value,D=X.actionType,z=X.entityKey,Oj=X.actionMetadata,D&&z&&Oj&&!g.I(Oj,MuB)){D==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(Oj.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if($l=g.I(H.actionMetadata,DC))$l.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",H.actionMetadata=Object.assign({},H.actionMetadata,{mainVideoEntityActionMetadata:$l});G.push(H)}g.xl(BJ,
7);break;case 6:return ey=g.rc(BJ),Nm="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",a_="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",ey instanceof g.eI&&ey.type==="QUOTA_EXCEEDED"&&(Nm="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",a_="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),BJ.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,Nm,a_));case 7:return BJ.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,G))}})},SLx=function(){za.apply(this,
arguments);
this.J="mainVideoEntity"},feJ=function(q,a,w){a=a===void 0?43200:a;
w=w===void 0?!0:w;var G=G===void 0?!1:G;var k,b,O;return g.h(function(e){switch(e.U){case 1:if(!q.L.GA())return e.return([]);k=[];g.ml(e,2);return g.n(e,nsJ(a,w,G),4);case 4:k=e.V;g.xl(e,3);break;case 2:b=g.rc(e),b instanceof Error&&b.message==="No data"||b instanceof Error&&b.message==="Empty response body"&&Ga(b.message);case 3:return O=YLx(q,k,w,"mainPlaylistEntity"),e.return(O)}})},H_K=function(q,a,w,G){G=G===void 0?!1:G;
var k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L;return g.h(function(M){switch(M.U){case 1:return k=[],g.n(M,Mdx(),2);case 2:return(b=M.V)||G?g.n(M,S5c(a,w),3):M.return([]);case 3:O=M.V;if((e=O)==null||!e.length)return M.return([]);N={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};Y=g.V(O);P=Y.next();case 4:if(P.done){M.Gl(6);break}d=K=P.value;T=d.actionType;F=d.entityKey;J=d.actionMetadata;if(!(T&&F&&J)||g.I(J,MuB)){M.Gl(5);break}T==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(J.offlineLoggingData=
N);Q=g.Ie(F);B=Q.entityId;return g.n(M,iC(q,[B],"mainVideoEntity",T,J),8);case 8:L=M.V,k=k.concat(L);case 5:P=Y.next();M.Gl(4);break;case 6:return M.return(k)}})},cKI=function(q,a){this.V=q;
this.W=a},UXR=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B;
return g.h(function(L){switch(L.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,b=[],g.ml(L,2),g.n(L,pnV(q,k),4);case 4:b=L.V;if((O=b)==null||!O.length){L.Gl(5);break}return g.n(L,JDK(q.V,a.entityKey),5);case 5:g.xl(L,3);break;case 2:return e=g.rc(L),N="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",e instanceof g.eI&&e.type==="QUOTA_EXCEEDED"&&(N="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
L.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,N,Y));case 3:return P=[],g.n(L,aHK(q.V,"musicTrack",b),7);case 7:b=L.V;if(b.length)for(K=g.V(b),d=K.next();!d.done;d=K.next())if(T=d.value,F=T.offlineVideoData,J=void 0,(J=F)==null?0:J.videoId)Q=void 0,B=Number(((Q=a.actionMetadata)==null?void 0:Q.priority)||0)+1,P.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",F.videoId,"musicTrack",B,Ry,ro(a,F,k)));return L.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,P))}})},
XnB=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6,hl,Gf,Al,m,wc,MW,em,jK,zf,wy,as,I6,A,E,x,S,U,KK,t,y;
return g.h(function(f){switch(f.U){case 1:return w=NB(a),G=a.entityKey,k=g.Ie(G).entityId,b=[],O=!1,k==="!*$_ALL_ENTITIES_!*$"?(O=!0,g.n(f,yU(q.V,"musicAlbumRelease"),5)):g.n(f,Ri(q.V,G,"musicAlbumRelease"),4);case 4:(e=f.V)&&b.push(e);f.Gl(3);break;case 5:b=f.V;case 3:if((N=b)==null||!N.length)return f.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));if(O){Y=[];P=g.V(b);for(K=P.next();!K.done;K=P.next())d=K.value,T=g.Ie(d.id).entityId,Y.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
T,"musicAlbumRelease",0,Ry));return f.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,Y))}F=[];J=b[0];Q=void 0;if(!J.downloadMetadata){f.Gl(6);break}return g.n(f,Ri(q.V,J.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:B=f.V,Q=Number((M=(L=B)==null?void 0:L.addedTimestampMillis)!=null?M:"0")/1E3;case 6:return g.ml(f,8),g.n(f,pnV(q,k,(H=Q)==null?void 0:H.toString()),10);case 10:F=f.V;g.xl(f,9);break;case 8:X=g.rc(f);if(!(X instanceof Error&&X.message==="No data")){if(X instanceof
Error&&X.message==="Empty response body")Ga(X.message);else return D="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",X instanceof g.eI&&X.type==="QUOTA_EXCEEDED"&&(D="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),f.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,D,z));f.Gl(9);break}return g.n(f,Lq(k,"musicAlbumRelease",q.V,a,q.W),9);case 9:Oj=[];$l=new Map;
if((ey=F)==null?0:ey.length)for(Nm=g.V(F),a_=Nm.next();!a_.done;a_=Nm.next())BJ=a_.value,WJ=BJ.offlineVideoData,gy=void 0,((gy=WJ)==null?0:gy.videoId)&&$l.set(WJ.videoId,WJ);F8=new Map;eK=[];if((Mm=J)==null?0:(O7=Mm.tracks)==null?0:O7.length)for(cR=g.V(J.tracks),uV=cR.next();!uV.done;uV=cR.next())if(lb=uV.value,r=g.Ie(lb).entityId)$l.has(r)?(F8.set(r,$l.get(r)),$l.delete(r)):eK.push(r);hl=Number(((o6=a.actionMetadata)==null?void 0:o6.priority)||0)+1;Gf=g.V($l.entries());for(Al=Gf.next();!Al.done;Al=
Gf.next())m=Al.value,wc=g.V(m),MW=wc.next().value,em=wc.next().value,jK=MW,zf=em,Oj.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",jK,"musicTrack",hl,Ry,ro(a,zf)));wy=g.V(F8.entries());for(as=wy.next();!as.done;as=wy.next())I6=as.value,A=g.V(I6),E=A.next().value,x=A.next().value,S=E,U=x,Oj.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",S,"musicTrack",hl,Ry,ro(a,U)));KK=g.V(eK);for(t=KK.next();!t.done;t=KK.next())y=t.value,Oj.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",y,"musicTrack",
0,Ry));return f.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,Oj))}})},jIx=function(q,a){var w,G;
return g.h(function(k){switch(k.U){case 1:return w=NB(a),g.ml(k,2),G=g.Ie(a.entityKey).entityId,G==="!*$_ALL_ENTITIES_!*$"?g.n(k,BM(q.V,a,q.W),5):g.n(k,Lq(G,"musicAlbumRelease",q.V,a,q.W),6);case 6:return g.n(k,mbI(q.V,a.entityKey),5);case 5:g.xl(k,3);break;case 2:return g.rc(k),k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},pnV=function(q,a,w){var G,k,b;
return g.h(function(O){switch(O.U){case 1:return g.n(O,B_B([a]),2);case 2:return G=O.V,g.n(O,ogc(q,G[0],w),3);case 3:return k=O.V,b=F6(k.thumbnailDetails),g.n(O,JC(b),4);case 4:return O.return(G[0].videos)}})},ogc=function(q,a,w){var G,k,b,O,e,N,Y,P,K,d,T,F,J,Q;
return g.h(function(B){if(B.U==1){G=a.additionalMetadadatas;k=void 0;if(G&&G.length>0)for(b=g.V(G),O=b.next();!O.done;O=b.next())if(e=O.value,e.offlineMusicPlaylistData){k=e.offlineMusicPlaylistData;break}N=a.playlistId;Y=Q16(a);P=Y.SY;K=Y.Cp;d=w?(Number(w)*1E3).toString():Date.now().toString();T=a.lastModifiedTimestamp?(Number(a.lastModifiedTimestamp)*1E3).toString():"0";F={id:g.uH(N,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:K,lastModifiedTimestampMillis:T,addedTimestampMillis:d,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};J={id:g.uH(N,"musicAlbumRelease"),title:a.title,audioPlaylistId:N,trackCount:a.totalVideoCount,tracks:P,downloadMetadata:F.id};k&&(J.thumbnailDetails=(Q=k.albumHqThumbnail)!=null?Q:k.albumArtistThumbnail,J.artistDisplayName=k.albumArtistDisplayName,J.releaseDate=k.albumReleaseDate,J.contentRating={explicitType:k.albumReleaseExplicitType},J.releaseType=k.albumReleaseType);return g.n(B,Wu(q.V,{mode:"readwrite",EA:!0},function(L){var M=tJ(L,J,"musicAlbumRelease");
L=tJ(L,F,"musicAlbumReleaseDownloadMetadataEntity");return g.$7.all([M,L])}),2)}return B.return(J)})},Ie6=function(q,a){this.V=q;
this.W=a},tu7=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B;
return g.h(function(L){switch(L.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,b=[],g.ml(L,2),g.n(L,ugI(q,k),4);case 4:b=L.V;if((O=b)==null||!O.length){L.Gl(5);break}return g.n(L,JDK(q.V,a.entityKey),5);case 5:g.xl(L,3);break;case 2:return e=g.rc(L),N="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",e instanceof g.eI&&e.type==="QUOTA_EXCEEDED"&&(N="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Y="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
L.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,N,Y));case 3:return P=[],g.n(L,aHK(q.V,"musicTrack",b),7);case 7:b=L.V;if(b.length)for(K=g.V(b),d=K.next();!d.done;d=K.next())if(T=d.value,F=T.offlineVideoData,J=void 0,(J=F)==null?0:J.videoId)Q=void 0,B=Number(((Q=a.actionMetadata)==null?void 0:Q.priority)||0)+1,P.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",F.videoId,"musicTrack",B,y3,ro(a,F,k)));return L.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,P))}})},
vg6=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV,lb,r,o6,hl,Gf,Al,m,wc,MW,em,jK,zf,wy,as,I6,A,E,x,S,U,KK,t,y,f,fK,I_,lG,PR,hm,Am,aR,Qx,pw,LK,JM;
return g.h(function(nK){switch(nK.U){case 1:return w=NB(a),G=a.entityKey,k=g.Ie(G).entityId,b=[],O=!1,k==="!*$_ALL_ENTITIES_!*$"?(O=!0,g.n(nK,yU(q.V,"musicPlaylist"),5)):g.n(nK,Ri(q.V,G,"musicPlaylist"),4);case 4:(e=nK.V)&&b.push(e);nK.Gl(3);break;case 5:b=nK.V;case 3:if((N=b)==null||!N.length)return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));Y=g.I(a.actionMetadata,ADB);K=(P=Y)==null?void 0:P.autoSync;d=[];F=T=!0;J=!1;Q=void 0;if(!O&&K===!1){nK.Gl(6);break}g.ml(nK,7);return g.n(nK,
fHJ(0,!!K,!0,b),9);case 9:d=nK.V;g.xl(nK,8);break;case 7:B=g.rc(nK);if(!(B instanceof Error&&B.message==="No data")){B instanceof Error&&B.message==="Empty response body"&&Ga(B.message);nK.Gl(8);break}return k==="!*$_ALL_ENTITIES_!*$"?g.n(nK,BM(q.V,a,q.W),8):g.n(nK,Lq(k,"musicPlaylist",q.V,a,q.W),8);case 8:if(!d.length||!O&&d[0].playlistId!==k)return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));case 6:if(O){L=[];M=g.V(d);for(H=M.next();!H.done;H=M.next())X=H.value,X.upToDate||
K&&!X.shouldAutoSyncMetadata||!X.playlistId||(D={autoSync:K},L.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",X.playlistId,"musicPlaylist",0,y3,{musicPlaylistEntityActionMetadata:D})));return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,L))}d.length&&(z=d[0],J=!!z.upToDate,K&&(T=(Oj=z.shouldAutoSyncMetadata)!=null?Oj:!0,F=($l=z.shouldAutoSyncVideos)!=null?$l:!0,z.checkInSeconds&&(Q=z.checkInSeconds)));if(J||!T)return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w));ey=[];Nm=b[0];a_=void 0;if(!Nm.downloadMetadata){nK.Gl(15);break}return g.n(nK,Ri(q.V,Nm.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:BJ=nK.V,a_=Number((gy=(WJ=BJ)==null?void 0:WJ.addedTimestampMillis)!=null?gy:"0")/1E3;case 15:return g.ml(nK,17),g.n(nK,ugI(q,k,(F8=a_)==null?void 0:F8.toString(),Q),19);case 19:ey=nK.V;g.xl(nK,18);break;case 17:eK=g.rc(nK);if(!(eK instanceof Error&&eK.message==="No data")){if(eK instanceof Error&&eK.message==="Empty response body")Ga(eK.message);
else return Mm="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",O7="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",eK instanceof g.eI&&eK.type==="QUOTA_EXCEEDED"&&(Mm="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",O7="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,Mm,O7));nK.Gl(18);break}return g.n(nK,Lq(k,"musicPlaylist",q.V,a,q.W),18);case 18:if(!F)return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w));cR=[];uV=new Map;if((lb=ey)==null?0:lb.length)for(r=g.V(ey),o6=r.next();!o6.done;o6=r.next())hl=o6.value,Gf=hl.offlineVideoData,Al=void 0,((Al=Gf)==null?0:Al.videoId)&&uV.set(Gf.videoId,Gf);m=new Map;wc=[];if((MW=Nm)==null?0:(em=MW.tracks)==null?0:em.length)for(jK=g.V(Nm.tracks),zf=jK.next();!zf.done;zf=jK.next())if(wy=zf.value,as=g.Ie(wy).entityId)uV.has(as)?(m.set(as,uV.get(as)),uV.delete(as)):wc.push(as);A=Number(((I6=a.actionMetadata)==null?void 0:I6.priority)||0)+1;E=g.V(uV.entries());for(x=
E.next();!x.done;x=E.next())S=x.value,U=g.V(S),KK=U.next().value,t=U.next().value,y=KK,f=t,cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",y,"musicTrack",A,y3,ro(a,f)));fK=g.V(m.entries());for(I_=fK.next();!I_.done;I_=fK.next())lG=I_.value,PR=g.V(lG),hm=PR.next().value,Am=PR.next().value,aR=hm,Qx=Am,cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",aR,"musicTrack",A,y3,ro(a,Qx)));pw=g.V(wc);for(LK=pw.next();!LK.done;LK=pw.next())JM=LK.value,cR.push(Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
JM,"musicTrack",0,y3));return nK.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,cR))}})},zHl=function(q,a){var w,G;
return g.h(function(k){switch(k.U){case 1:return w=NB(a),g.ml(k,2),G=g.Ie(a.entityKey).entityId,G==="!*$_ALL_ENTITIES_!*$"?g.n(k,BM(q.V,a,q.W),5):g.n(k,Lq(G,"musicPlaylist",q.V,a,q.W),6);case 6:return g.n(k,mbI(q.V,a.entityKey),5);case 5:g.xl(k,3);break;case 2:return g.rc(k),k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},ugI=function(q,a,w,G){var k,b,O;
return g.h(function(e){switch(e.U){case 1:return g.n(e,B_B([a]),2);case 2:return k=e.V,g.n(e,i_J(q,k[0],w,G),3);case 3:return b=e.V,O=F6(b.thumbnailDetails),g.n(e,JC(O),4);case 4:return e.return(k[0].videos)}})},i_J=function(q,a,w,G){var k,b,O,e,N,Y,P,K,d;
return g.h(function(T){return T.U==1?(k=a.playlistId,b=Q16(a),O=b.SY,e=b.Cp,N=w?(Number(w)*1E3).toString():Date.now().toString(),Y=a.lastModifiedTimestamp?(Number(a.lastModifiedTimestamp)*1E3).toString():"0",P={id:g.uH(k,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:e,lastModifiedTimestampMillis:Y,addedTimestampMillis:N,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},K={id:g.uH(k,"musicPlaylist"),title:a.title,playlistId:k,thumbnailDetails:a.thumbnail,visibility:WjR(a),trackCount:a.totalVideoCount,
tracks:O,downloadMetadata:P.id},G&&(((d=K)==null?0:d.entityMetadata)?K.entityMetadata.nextAutoRefreshIntervalSeconds=String(G):K&&(K.entityMetadata={nextAutoRefreshIntervalSeconds:String(G)})),g.n(T,Wu(q.V,{mode:"readwrite",EA:!0},function(F){var J=tJ(F,K,"musicPlaylist");F=tJ(F,P,"musicPlaylistDownloadMetadataEntity");return g.$7.all([J,F])}),2)):T.return(K)})},WjR=function(q){switch(q.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},DXc=function(q,a){this.V=q;
this.W=a},gnR=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F;
return g.h(function(J){switch(J.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,b=g.I(a.actionMetadata,RHl),g.ml(J,2),g.n(J,yKB(q,k,void 0,(O=b)==null?void 0:O.track,(e=b)==null?void 0:e.albumRelease),4);case 4:if((N=b)==null?0:N.playlistId){J.Gl(5);break}return g.n(J,JDK(q.V,a.entityKey),5);case 5:g.xl(J,3);break;case 2:return Y=g.rc(J),P="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Y instanceof g.eI&&Y.type==="QUOTA_EXCEEDED"&&
(P="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",K="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),J.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,P,K));case 3:T=Number(((d=a.actionMetadata)==null?void 0:d.priority)||0)+1;var Q=(Q=g.I(a.actionMetadata,RHl))?{playbackDataActionMetadata:{maximumDownloadQuality:Q.maximumDownloadQuality}}:void 0;F=Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",k,"playbackData",T,qFe,Q);return J.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w,[F]))}})},aSI=function(q,a){var w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q;
return g.h(function(B){switch(B.U){case 1:return w=NB(a),G=g.Ie(a.entityKey),k=G.entityId,g.n(B,Ri(q.V,a.entityKey,"musicTrack"),2);case 2:b=B.V;if(!b){O=void 0;B.Gl(3);break}return g.n(B,Ri(q.V,b.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:O=B.V;case 3:e=O;if(!b||!e)return B.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w));Y=g.I(a.actionMetadata,RHl);g.ml(B,5);return g.n(B,yKB(q,k,e.addedTimestampMillis,(P=Y)==null?void 0:P.track,(K=Y)==null?void 0:K.albumRelease),
7);case 7:T=Number(((d=a.actionMetadata)==null?void 0:d.priority)||0)+1;N=Sq("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",k,"playbackData",T,qFe);g.xl(B,6);break;case 5:F=g.rc(B);if(!(F instanceof Error&&F.message==="No data")){if(F instanceof Error&&F.message==="Empty response body")Ga(F.message);else return J="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Q="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",F instanceof g.eI&&F.type==="QUOTA_EXCEEDED"&&(J="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
Q="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),B.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,J,Q));B.Gl(6);break}return g.n(B,x2(k,q.V,a,q.W),6);case 6:return B.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",w,N?[N]:void 0))}})},wrU=function(q,a){var w,G;
return g.h(function(k){switch(k.U){case 1:return w=NB(a),g.ml(k,2),G=g.Ie(a.entityKey).entityId,G==="!*$_ALL_ENTITIES_!*$"?g.n(k,BM(q.V,a,q.W),5):g.n(k,x2(G,q.V,a,q.W),6);case 6:return g.n(k,mbI(q.V,a.entityKey),5);case 5:g.xl(k,3);break;case 2:return g.rc(k),k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",w,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return k.return(new fq("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
w))}})},yKB=function(q,a,w,G,k){var b,O,e,N,Y,P;
return g.h(function(K){switch(K.U){case 1:if(b=G){K.Gl(2);break}return g.n(K,LYc([a]),3);case 3:O=K.V,e=O[0],b=Vdw(e);case 2:return g.n(K,Gn6(q,b,a,k,w),4);case 4:N=K.V;Y=N.musicTrackEntity;P=N.fV;var d=F6(Y.thumbnailDetails),T=[];P&&(T=F6(P.thumbnailDetails));return g.n(K,JC(d.concat(T)),0)}})},Gn6=function(q,a,w,G,k){var b;
return g.h(function(O){return O.U==1?(k||(k=Date.now().toString()),b={id:g.uH(w,"musicTrackDownloadMetadataEntity"),playbackData:g.uH(w,"playbackData"),addedTimestampMillis:k,videoDownloadContextEntity:g.uH(w,"videoDownloadContextEntity")},G&&(a.albumRelease=G.id),g.n(O,Wu(q.V,{mode:"readwrite",EA:!0},function(e){var N=[],Y=tJ(e,b,"musicTrackDownloadMetadataEntity");N.push(Y);Y=tJ(e,a,"musicTrack");N.push(Y);G&&(e=tJ(e,G,"musicAlbumRelease"),N.push(e));return g.$7.all(N)}),2)):O.U!=3?g.n(O,Ta(w,"musicTrackDownloadMetadataEntity",
q.V,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):O.return({musicTrackEntity:a,
fV:G})})},qa=function(){za.apply(this,arguments);
this.J="musicTrack"},kny=function(q,a,w){a=a===void 0?43200:a;
w=w===void 0?!0:w;var G=G===void 0?!1:G;var k,b;return g.h(function(O){switch(O.U){case 1:if(!q.L.GA())return O.return([]);k=[];g.ml(O,2);return g.n(O,fHJ(a,w,G),4);case 4:k=O.V;g.xl(O,3);break;case 2:g.rc(O);case 3:return b=YLx(q,k,w,"musicPlaylist"),O.return(b)}})},byR=function(){g.md.apply(this,arguments);
var q=this;this.events=new g.Ee(this);this.V7=this.player.B();this.qh={tjt:function(){return q.V},
lW:function(){return q.lW()},
Ey:function(a){return q.Ey(a)}}},OyR=function(q){var a;
q=g.I((a=q.getWatchNextResponse())==null?void 0:a.currentVideoEndpoint,g.Er);if(q==null?0:q.playlistId)var w=q.playlistId;return w},lSl=function(q,a){var w,G,k,b;
return g.h(function(O){if(O.U==1){w=a.clientPlaybackNonce;G={cpn:w,offlineSourceVisualElement:g.KF(a.L7||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};a.U&&(G.videoFmt=Number(a.U.itag));a.Y&&(G.audioFmt=Number(a.Y.itag));if((k=OyR(a))&&a.videoId){var e=a.videoId;e=k!=="PPSV"?Promise.resolve(!1):q.V.CA(e);O=g.n(O,e,3)}else O=O.Gl(2);return O}O.U!=2&&(b=O.V)&&(G.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");q.U=w;g.aw("offlinePlaybackStarted",G);g.Jm(O)})};
g.o$.prototype.hx=g.kl(45,function(q){return this.app.hx(q)});
g.Tb.prototype.hx=g.kl(44,function(q){return g.Tf_(this,9,q)});
g.Z(cu,Hu);g.bG.Object.defineProperties(cu.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.V.entityMetadata},
set:function(q){this.V.entityMetadata=q}}});
g.Z(DEV,cu);DEV.prototype.U=function(){return[]};
g.Z(RGK,cu);RGK.prototype.U=function(){return[]};
g.Z(ypJ,cu);ypJ.prototype.U=function(){return[]};
g.Z(qhU,cu);qhU.prototype.U=function(){return[]};
g.Z(gF7,cu);gF7.prototype.U=function(){return[]};
g.Z(a36,cu);a36.prototype.U=function(){var q=[];this.V.alternateChannel&&q.push(this.V.alternateChannel);this.V.alternateChannelList&&q.push.apply(q,g.Tf(this.V.alternateChannelList));this.V.oneofChannelEntity&&q.push(this.V.oneofChannelEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(w2c,cu);w2c.prototype.U=function(){var q=[];this.V.entryCollection&&q.push(this.V.entryCollection);return[].concat(g.Tf(new Set(q)))};
g.Z(Gyw,Hu);Gyw.prototype.U=function(){var q=[];this.V.video&&q.push(this.V.video);return[].concat(g.Tf(new Set(q)))};
g.Z(kyK,cu);kyK.prototype.U=function(){var q=[];this.V.parentPlaylist&&q.push(this.V.parentPlaylist);if(this.V.entries)for(var a=g.V(this.V.entries),w=a.next();!w.done;w=a.next())q.push.apply(q,g.Tf((new Gyw(w.value)).U()));return[].concat(g.Tf(new Set(q)))};
g.Z(bVe,cu);bVe.prototype.U=function(){var q=[];this.V.descriptionEntity&&q.push(this.V.descriptionEntity);this.V.creators&&q.push.apply(q,g.Tf(this.V.creators));this.V.theBiggestFan&&q.push(this.V.theBiggestFan);return[].concat(g.Tf(new Set(q)))};
g.Z(OVV,cu);OVV.prototype.U=function(){return[]};
g.Z(l3c,cu);l3c.prototype.U=function(){return[]};
g.Z(edU,cu);edU.prototype.U=function(){return[]};
g.Z(N9B,cu);N9B.prototype.U=function(){return[]};
g.Z(Yhe,cu);Yhe.prototype.U=function(){return[]};
g.Z(PLy,cu);PLy.prototype.U=function(){return[]};
g.Z(KLR,cu);KLR.prototype.U=function(){return[]};
g.Z(doJ,cu);doJ.prototype.U=function(){return[]};
g.Z(T96,cu);T96.prototype.U=function(){return[]};
g.Z($ow,cu);$ow.prototype.U=function(){var q=[];this.V.downloadsList&&q.push(this.V.downloadsList);this.V.smartDownloadsList&&q.push(this.V.smartDownloadsList);this.V.recommendedDownloadsList&&q.push(this.V.recommendedDownloadsList);this.V.refresh&&q.push(this.V.refresh);return[].concat(g.Tf(new Set(q)))};
g.Z(suB,Hu);suB.prototype.U=function(){var q=[];this.V.video&&q.push(this.V.video);this.V.playlist&&q.push(this.V.playlist);this.V.videoItem&&q.push(this.V.videoItem);this.V.playlistItem&&q.push(this.V.playlistItem);return[].concat(g.Tf(new Set(q)))};
g.Z(FLK,cu);FLK.prototype.U=function(){var q=[];this.V.refresh&&q.push(this.V.refresh);if(this.V.downloads)for(var a=g.V(this.V.downloads),w=a.next();!w.done;w=a.next())q.push.apply(q,g.Tf((new suB(w.value)).U()));return[].concat(g.Tf(new Set(q)))};
g.Z(CLe,cu);CLe.prototype.U=function(){var q=[];this.V.localImageEntities&&q.push.apply(q,g.Tf(this.V.localImageEntities));return[].concat(g.Tf(new Set(q)))};
g.Z(ZVl,cu);ZVl.prototype.U=function(){var q=[];this.V.playbackData&&q.push(this.V.playbackData);this.V.localImageEntities&&q.push.apply(q,g.Tf(this.V.localImageEntities));this.V.videoDownloadContextEntity&&q.push(this.V.videoDownloadContextEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(EFJ,cu);EFJ.prototype.U=function(){return[]};
g.Z(VzU,cu);VzU.prototype.U=function(){var q=[];this.V.fakeChildren&&q.push.apply(q,g.Tf(this.V.fakeChildren));return[].concat(g.Tf(new Set(q)))};
g.Z(J1R,cu);J1R.prototype.U=function(){var q=[];this.V.video&&q.push(this.V.video);this.V.playbackData&&q.push(this.V.playbackData);this.V.offlineVideoPolicy&&q.push(this.V.offlineVideoPolicy);return[].concat(g.Tf(new Set(q)))};
g.Z(moB,cu);moB.prototype.U=function(){return[]};
g.Z(Qux,cu);Qux.prototype.U=function(){var q=[];this.V.channelOwner&&q.push(this.V.channelOwner);this.V.videos&&q.push.apply(q,g.Tf(this.V.videos));this.V.collaboratorChannels&&q.push.apply(q,g.Tf(this.V.collaboratorChannels));this.V.downloadState&&q.push(this.V.downloadState);this.V.refresh&&q.push(this.V.refresh);return[].concat(g.Tf(new Set(q)))};
g.Z(A17,cu);A17.prototype.U=function(){var q=[];this.V.video&&q.push(this.V.video);this.V.channelContributor&&q.push(this.V.channelContributor);return[].concat(g.Tf(new Set(q)))};
g.Z(xoU,Hu);xoU.prototype.U=function(){var q=[];this.V.localImageEntities&&q.push.apply(q,g.Tf(this.V.localImageEntities));this.V.videoDownloadContextEntity&&q.push(this.V.videoDownloadContextEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(LLc,Hu);LLc.prototype.U=function(){var q=[];this.V.recommendedVideoMetadata&&q.push.apply(q,g.Tf((new xoU(this.V.recommendedVideoMetadata)).U()));return[].concat(g.Tf(new Set(q)))};
g.Z(B9J,Hu);B9J.prototype.U=function(){var q=[];this.V.playbackPosition&&q.push(this.V.playbackPosition);return[].concat(g.Tf(new Set(q)))};
g.Z(r1y,cu);r1y.prototype.U=function(){var q=[];this.V.owner&&q.push(this.V.owner);this.V.downloadState&&q.push(this.V.downloadState);this.V.userState&&q.push.apply(q,g.Tf((new B9J(this.V.userState)).U()));this.V.additionalMetadata&&q.push.apply(q,g.Tf((new LLc(this.V.additionalMetadata)).U()));return[].concat(g.Tf(new Set(q)))};
g.Z(nFU,cu);nFU.prototype.U=function(){var q=[];this.V.userChannelDetails&&q.push(this.V.userChannelDetails);return[].concat(g.Tf(new Set(q)))};
g.Z(Mzl,cu);Mzl.prototype.U=function(){var q=[];this.V.channelOwner&&q.push(this.V.channelOwner);this.V.playbackPosition&&q.push(this.V.playbackPosition);this.V.localImageEntities&&q.push.apply(q,g.Tf(this.V.localImageEntities));this.V.downloadStatus&&q.push(this.V.downloadStatus);return[].concat(g.Tf(new Set(q)))};
g.Z(hd7,cu);hd7.prototype.U=function(){return[]};
g.Z(ShK,cu);ShK.prototype.U=function(){return[]};
g.Z(f36,cu);f36.prototype.U=function(){return[]};
g.Z(HVV,cu);HVV.prototype.U=function(){return[]};
g.Z(c1B,cu);c1B.prototype.U=function(){return[]};
g.Z(p2x,cu);p2x.prototype.U=function(){return[]};
g.Z(Uoe,cu);Uoe.prototype.U=function(){return[]};
g.Z(X2y,cu);X2y.prototype.U=function(){return[]};
g.Z(juU,cu);juU.prototype.U=function(){return[]};
g.Z(oFR,cu);oFR.prototype.U=function(){return[]};
g.Z(I3y,cu);I3y.prototype.U=function(){return[]};
g.Z(uk8,cu);uk8.prototype.U=function(){return[]};
g.Z(tzw,cu);tzw.prototype.U=function(){var q=[];this.V.trackDownloadMetadatas&&q.push.apply(q,g.Tf(this.V.trackDownloadMetadatas));return[].concat(g.Tf(new Set(q)))};
g.Z(vFI,cu);
vFI.prototype.U=function(){var q=[];this.V.downloadedTracks&&q.push.apply(q,g.Tf(this.V.downloadedTracks));this.V.smartDownloadedTracks&&q.push.apply(q,g.Tf(this.V.smartDownloadedTracks));this.V.downloadedEpisodes&&q.push.apply(q,g.Tf(this.V.downloadedEpisodes));this.V.downloadedAlbumReleases&&q.push.apply(q,g.Tf(this.V.downloadedAlbumReleases));this.V.smartDownloadedAlbumReleases&&q.push.apply(q,g.Tf(this.V.smartDownloadedAlbumReleases));this.V.downloadedPlaylists&&q.push.apply(q,g.Tf(this.V.downloadedPlaylists));this.V.smartDownloadedPlaylists&&
q.push.apply(q,g.Tf(this.V.smartDownloadedPlaylists));this.V.metadataOnlyTracks&&q.push.apply(q,g.Tf(this.V.metadataOnlyTracks));return[].concat(g.Tf(new Set(q)))};
g.Z(zdK,cu);zdK.prototype.U=function(){var q=[];this.V.trackDownloadMetadatas&&q.push.apply(q,g.Tf(this.V.trackDownloadMetadatas));return[].concat(g.Tf(new Set(q)))};
g.Z(iVc,cu);iVc.prototype.U=function(){var q=[];this.V.playbackData&&q.push(this.V.playbackData);this.V.localImageEntities&&q.push.apply(q,g.Tf(this.V.localImageEntities));this.V.videoDownloadContextEntity&&q.push(this.V.videoDownloadContextEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(WLy,cu);WLy.prototype.U=function(){var q=[];this.V.musicLibraryStatusEntity&&q.push(this.V.musicLibraryStatusEntity);this.V.primaryArtists&&q.push.apply(q,g.Tf(this.V.primaryArtists));this.V.details&&q.push(this.V.details);this.V.userDetails&&q.push(this.V.userDetails);this.V.tracks&&q.push.apply(q,g.Tf(this.V.tracks));this.V.share&&q.push(this.V.share);this.V.downloadMetadata&&q.push(this.V.downloadMetadata);this.V.refresh&&q.push(this.V.refresh);return[].concat(g.Tf(new Set(q)))};
g.Z(Doc,cu);Doc.prototype.U=function(){var q=[];this.V.albumRelease&&q.push(this.V.albumRelease);this.V.tracks&&q.push.apply(q,g.Tf(this.V.tracks));return[].concat(g.Tf(new Set(q)))};
g.Z(RdJ,cu);RdJ.prototype.U=function(){var q=[];this.V.albumRelease&&q.push(this.V.albumRelease);return[].concat(g.Tf(new Set(q)))};
g.Z(y18,cu);y18.prototype.U=function(){var q=[];this.V.details&&q.push(this.V.details);this.V.userDetails&&q.push(this.V.userDetails);return[].concat(g.Tf(new Set(q)))};
g.Z(qqR,cu);qqR.prototype.U=function(){var q=[];this.V.parentArtist&&q.push(this.V.parentArtist);return[].concat(g.Tf(new Set(q)))};
g.Z(gE6,cu);gE6.prototype.U=function(){var q=[];this.V.parentArtist&&q.push(this.V.parentArtist);return[].concat(g.Tf(new Set(q)))};
g.Z(aG7,cu);aG7.prototype.U=function(){return[]};
g.Z(wOR,cu);wOR.prototype.U=function(){return[]};
g.Z(G_y,Hu);G_y.prototype.U=function(){var q=[];this.V.creatorEntity&&q.push(this.V.creatorEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(k_l,cu);
k_l.prototype.U=function(){var q=[];this.V.tracks&&q.push.apply(q,g.Tf(this.V.tracks));this.V.refresh&&q.push(this.V.refresh);this.V.musicLibraryStatusEntity&&q.push(this.V.musicLibraryStatusEntity);this.V.details&&q.push(this.V.details);this.V.downloadMetadata&&q.push(this.V.downloadMetadata);this.V.sideloadMetadata&&q.push(this.V.sideloadMetadata);this.V.userDetails&&q.push(this.V.userDetails);this.V.entryCollection&&q.push(this.V.entryCollection);this.V.share&&q.push(this.V.share);this.V.podcastShowAdditionalMetadata&&
q.push.apply(q,g.Tf((new G_y(this.V.podcastShowAdditionalMetadata)).U()));return[].concat(g.Tf(new Set(q)))};
g.Z(bT6,cu);bT6.prototype.U=function(){return[]};
g.Z(OTJ,cu);
OTJ.prototype.U=function(){var q=[];this.V.musicLibraryStatusEntity&&q.push(this.V.musicLibraryStatusEntity);this.V.artists&&q.push.apply(q,g.Tf(this.V.artists));this.V.audioModeVersion&&q.push(this.V.audioModeVersion);this.V.videoModeVersion&&q.push(this.V.videoModeVersion);this.V.userDetails&&q.push(this.V.userDetails);this.V.details&&q.push(this.V.details);this.V.albumRelease&&q.push(this.V.albumRelease);this.V.share&&q.push(this.V.share);this.V.libraryEdit&&q.push(this.V.libraryEdit);this.V.downloadMetadata&&
q.push(this.V.downloadMetadata);this.V.playbackPosition&&q.push(this.V.playbackPosition);this.V.lyrics&&q.push(this.V.lyrics);return[].concat(g.Tf(new Set(q)))};
g.Z(lG6,cu);lG6.prototype.U=function(){var q=[];this.V.parentTrack&&q.push(this.V.parentTrack);return[].concat(g.Tf(new Set(q)))};
g.Z(eEe,cu);eEe.prototype.U=function(){var q=[];this.V.parentTrack&&q.push(this.V.parentTrack);return[].concat(g.Tf(new Set(q)))};
g.Z(NHB,cu);NHB.prototype.U=function(){return[]};
g.Z(Yqx,cu);Yqx.prototype.U=function(){return[]};
g.Z(PyB,cu);PyB.prototype.U=function(){return[]};
g.Z(K$x,cu);K$x.prototype.U=function(){return[]};
g.Z(dIV,cu);dIV.prototype.U=function(){var q=[];this.V.transfer&&q.push(this.V.transfer);this.V.adsPlaybackData&&q.push.apply(q,g.Tf(this.V.adsPlaybackData));this.V.drmLicense&&q.push(this.V.drmLicense);this.V.offlineVideoPolicy&&q.push(this.V.offlineVideoPolicy);this.V.videoDownloadContextEntity&&q.push(this.V.videoDownloadContextEntity);return[].concat(g.Tf(new Set(q)))};
g.Z(TH7,cu);TH7.prototype.U=function(){return[]};
g.Z($II,cu);$II.prototype.U=function(){var q=[];this.V.offlineVideoStreams&&q.push.apply(q,g.Tf(this.V.offlineVideoStreams));this.V.captionTrack&&q.push.apply(q,g.Tf(this.V.captionTrack));return[].concat(g.Tf(new Set(q)))};
g.Z(slc,cu);slc.prototype.U=function(){return[]};
g.Z(F$V,cu);F$V.prototype.U=function(){return[]};
g.Z(CyR,cu);CyR.prototype.U=function(){return[]};
g.Z(ZTK,cu);ZTK.prototype.U=function(){return[]};
g.Z(EER,cu);EER.prototype.U=function(){return[]};
g.Z(VYV,cu);VYV.prototype.U=function(){return[]};
g.Z(Jtx,cu);Jtx.prototype.U=function(){return[]};
g.Z(mIJ,cu);mIJ.prototype.U=function(){return[]};
g.Z(Ql6,cu);Ql6.prototype.U=function(){return[]};
g.Z(AtI,cu);AtI.prototype.U=function(){return[]};
g.Z(xIR,cu);xIR.prototype.U=function(){return[]};
g.Z(L$c,cu);L$c.prototype.U=function(){return[]};
g.Z(BH8,cu);BH8.prototype.U=function(){return[]};
g.Z(rtK,cu);rtK.prototype.U=function(){return[]};
g.Z(nE6,cu);nE6.prototype.U=function(){return[]};
g.Z(MYI,cu);MYI.prototype.U=function(){return[]};
g.Z(hEU,cu);hEU.prototype.U=function(){return[]};
g.Z(SqI,cu);SqI.prototype.U=function(){return[]};
g.Z(fGU,cu);fGU.prototype.U=function(){return[]};
g.Z(HTR,cu);HTR.prototype.U=function(){return[]};
g.Z(ctR,cu);ctR.prototype.U=function(){return[]};
var HJR=["browse","music/browse","unplugged/browse"],j1l=["offline/playlist_sync_check"],xbx=["offline"],cD6=["offline/offline_video_playback_position_sync"],UbU=["offline/get_playback_data_entity"],pu;UG.getInstance=function(){return g.h(function(q){return q.return(new Promise(function(a){g.t2().then(function(w){w?(UG.instance||(UG.instance=new UG(w)),a(UG.instance)):a(void 0)})}))})};
UG.prototype.get=function(q){var a=this,w,G,k;return g.h(function(b){if(b.U==1)return g.n(b,jlw(a.token),2);if(b.U!=3)return w=b.V,g.n(b,w.get("prefs",q),3);G=b.V;if(!G)return b.return();k=(0,g.Zj)();return G.expirationTimestampMs<=k?b.return():b.return(G.value)})};
UG.prototype.set=function(q,a,w){w=w===void 0?31536E3:w;var G=this,k,b,O;return g.h(function(e){if(e.U==1)return k=(0,g.Zj)(),b={key:q,value:a,expirationTimestampMs:k+w*1E3},g.n(e,jlw(G.token),2);O=e.V;return g.n(e,g.x7(O,"prefs",b),0)})};
UG.prototype.remove=function(q){var a=this,w;return g.h(function(G){if(G.U==1)return g.n(G,jlw(a.token),2);w=G.V;return g.n(G,w.delete("prefs",q),0)})};
g.Z(Xn,g.UH);g.Z(jJ,vE8);jJ.prototype.W=function(q,a){a=iTV(a);q=(new TextEncoder).encode(JSON.stringify(q));return this.V.encrypt(q,a)};
jJ.prototype.U=function(q,a){if(!(q instanceof Uint8Array))throw oEl(1);var w=new TextDecoder;a=iTV(a);q=this.V.decrypt(q,a);return JSON.parse(w.decode(q))};
var W$x={accountLinkStatusEntity:edU,booleanEntity:qhU,buttonEntity:rtK,captionTrack:NHB,channelHandle:DEV,chipEntity:Jtx,commerceAcquisitionClientPayloadEntity:MYI,commerceCartListEntity:hEU,contextNoteFeedEntityPayload:RGK,contextNoteUserRatingEntityPayload:ypJ,continuationTokenEntity:moB,downloadQualityPickerEntity:KLR,downloadsPageRefreshTokenEntity:T96,downloadsPageViewConfigurationEntity:hd7,downloadStatusEntity:doJ,dismissState:mIJ,sfvAudioItemCurrentlyPlayingEntity:ZTK,emojiFountainDataEntity:L$c,
emojiCustomizationSetEntity:xIR,fakeChannel:a36,fakePlaylist:w2c,fakePlaylistEntryCollection:kyK,fakeVideo:bVe,fakeVideoDescription:OVV,featuredProductsEntity:oFR,flowStateEntity:l3c,iconBadgeEntity:SqI,interstitialInteractionStateEntity:Yhe,likeButtonAnimationEntity:ShK,liveChatPollStateEntity:PLy,liveViewerLeaderboardChatEntryPointStateEntity:F$V,liveViewerLeaderboardPointsEntity:CyR,liveReactionsDataEntity:BH8,logoEntity:N9B,macroMarkerEntity:f36,mainDownloadsLibraryEntity:$ow,mainDownloadsListEntity:FLK,
mainPlaylistDownloadStateEntity:CLe,mainPlaylistEntity:Qux,mainPlaylistVideoEntity:A17,mainVideoDownloadStateEntity:ZVl,mainVideoEntity:r1y,markersEngagementPanelSyncEntity:HVV,markersVisibilityOverrideEntity:c1B,musicAlbumReleaseDetail:Doc,musicAlbumReleaseDownloadMetadataEntity:tzw,musicAlbumRelease:WLy,musicAlbumReleaseUserDetail:RdJ,musicArtistDetail:qqR,musicArtist:y18,musicArtistUserDetail:gE6,musicDownloadsLibraryEntity:vFI,musicLibraryEdit:aG7,musicLibraryStatusEntity:wOR,musicPlaylist:k_l,
musicPlaylistDownloadMetadataEntity:zdK,musicShare:bT6,musicTrackDetail:lG6,musicTrackDownloadMetadataEntity:iVc,musicTrack:OTJ,musicTrackUserDetail:eEe,offlineOrchestrationActionWrapperEntity:Yqx,offlineVideoPolicy:PyB,offlineVideoStreams:K$x,offlineabilityEntity:EFJ,orchestrationWebSamplingEntity:VzU,pageHeaderEntity:Ql6,pdpStateEntity:fGU,pinnedProductEntity:I3y,playbackData:dIV,playerStateEntity:p2x,quantityIncrementerEntity:HTR,refresh:TH7,saveToPlaylistListEntity:EER,selectedChipIndexEntityPayload:Uoe,
settingEntity:VYV,stringEntity:gF7,suggestedFeedbackChipStateEntity:X2y,transfer:$II,trendingOfferEntity:uk8,videoDownloadContextEntity:slc,videoOverviewAsyncDataEntity:ctR,videoPlaybackPositionEntity:nE6,votingEntity:AtI,ytMainChannelEntity:nFU,youchatPendingResponseEntity:juU,ytMainDownloadedVideoEntity:J1R,ytMainVideoEntity:Mzl};g.Z(zq,vE8);zq.prototype.W=function(q){return q};
zq.prototype.U=function(q){if(q instanceof Uint8Array)throw oEl(0);return q};
g.Z(iS,g.c);iS.prototype.observe=function(q){var a=this;this.observers.push(q);return function(){var w=a.observers.indexOf(q);w>=0&&a.observers.splice(w,1)}};
iS.prototype.U=function(q){NV7(this,q.data)};
iS.prototype.qB=function(){this.channel.close()};
var TV8,KYV=new g.Ze("elementsCommand");var Q3=new g.Ze("entityBatchUpdate");var gsU=new g.Ze("downloadStatusEntity");var sII=new g.Ze("mainPlaylistEntityActionMetadata");var DC=new g.Ze("mainVideoEntityActionMetadata");var ADB=new g.Ze("musicPlaylistEntityActionMetadata");var RHl=new g.Ze("musicTrackEntityActionMetadata");var MuB=new g.Ze("localImageEntityActionMetadata");var HM=new g.Ze("playbackDataActionMetadata");var dGw=new g.Ze("transferEntityActionMetadata");var yDw=new g.Ze("videoPlaybackPositionEntityActionMetadata");var r$V;new g.Y8;new g.Y8;fXc.prototype.request=function(q,a,w){a=a===void 0?{}:a;return this.locks.request(q,a,function(G){return w(G)})};var wo=g.yV.caches,ay,X4R;go.prototype.open=function(q){return wo.open(p4l(q))};
go.prototype.has=function(q){return wo.has(p4l(q))};
go.prototype.delete=function(q){return wo.delete(p4l(q))};
go.prototype.match=function(q,a){var w=this,G,k,b,O,e,N;return g.h(function(Y){switch(Y.U){case 1:return g.n(Y,w.keys(),2);case 2:G=Y.V,k=g.V(G),b=k.next();case 3:if(b.done){Y.Gl(5);break}O=b.value;return g.n(Y,w.open(O),6);case 6:return e=Y.V,g.n(Y,e.match(q,a),7);case 7:if(N=Y.V)return Y.return(N);b=k.next();Y.Gl(3);break;case 5:return Y.return()}})};
g.Z(c$w,go);c$w.prototype.keys=function(){var q,a,w,G,k,b,O,e,N;return g.h(function(Y){if(Y.U==1)return q=[],a=g.Xt("CacheStorage keys"),g.n(Y,wo.keys(),2);w=Y.V;G=g.V(w);for(k=G.next();!k.done;k=G.next()){b=k.value;var P=b.indexOf(":");O=P===-1?{IV:b}:{IV:b.substring(0,P),datasyncId:b.substring(P+1)};e=O.IV;N=O.datasyncId;N===a&&q.push(e)}return Y.return(q)})};g.Z(k2,g.c);k2.prototype.W=function(q){this.api.zl("onOfflineOperationFailure",q.data)};
k2.prototype.Y=function(q){this.api.publish("offlinetransferpause",q.data)};
k2.prototype.qB=function(){var q;(q=this.V)==null||q.close();var a;(a=this.U)==null||a.close()};IX7.prototype.wx=function(){this.V&&OW(this)};
IX7.prototype.XM=function(){this.U&&this.U.resolve();this.W=this.V=!1;this.J()};var rXB=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var N_8="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var EsR="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.Z(IHl,hC);IHl.prototype.U=function(q){return Y2(q)?vsx(this,q):PM(q)?WY8(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};g.Z(Dbx,hC);Dbx.prototype.U=function(q){return PM(q)?RsV(this,q):q57(q)?q8B(this,q):Kq(q)?gXK(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};g.C=aWy.prototype;g.C.YAh=function(q){var a=this,w,G,k,b;return g.h(function(O){if(!g.v(q.state,128))return O.Gl(0);w=q.state.lT;var e=(G=w)==null?void 0:G.errorCode,N=(k=w)==null?void 0:k.wH;b=e==="net.connect"&&N===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(e==null?0:e.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.n(O,a.kt(a.player.getVideoData().videoId,b),0)})};
g.C.kt=function(q,a){var w=this;return g.h(function(G){if(G.U==1){if(w.U)return G.return();w.U=!0;return a==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(UW(w,q,!1,!0),G.Gl(0)):g.n(G,pq(w,q),3)}g.ap(q,4);return g.n(G,w.V.kt(a),0)})};
g.C.PZ=function(q){q.status===2?(q.status!==this.W&&(RT8(this.V),g.ap(q.videoId,2)),q.cg&&wnc(this.V,q.videoId,q.cg)):q.status===4?(pq(this,q.videoId),this.kt(q.videoId,q.eK?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):q.status===1&&ae8(this.V);this.W=q.status;this.api.zl("localmediachange",{videoId:q.videoId,status:q.status})};
g.C.Y8=function(){var q=this,a;return g.h(function(w){if(w.U==1){if(q.U)return w.return();q.U=!0;a=q.player.getVideoData().videoId;return g.n(w,pq(q,a),2)}return g.n(w,q.V.Y8(),0)})};
g.C.Zx=function(q){switch(q){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.C.T=function(q){return this.api.B().T(q)};g.Z(eT8,hC);eT8.prototype.U=function(q){return Y2(q)?Y8c(this,q):PM(q)?P9K(this,q):q57(q)?Kac(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};C9V.prototype.V=function(q,a){var w=q.action.actionMetadata.priority-a.action.actionMetadata.priority;w===0&&(q.V<a.V?w=-1:q.V>a.V&&(w=1));return w};g.Z(X6,g.c);X6.prototype.qB=function(){this.J&&this.J();g.c.prototype.qB.call(this)};
X6.prototype.createAction=function(q,a){var w=g.Ie(q.entityKey).entityType,G=g.K5(16);return new Cq(w,G,q,a.actionId,a.rootActionId)};
X6.prototype.UK=function(q){var a=this,w,G,k,b,O,e,N,Y,P;return g.h(function(K){if(K.U==1){if(a.t2())return K.return();G=(w=q.offlineOrchestrationActionWrapperEntity)!=null?w:new Set;k=[];b=g.V(G);for(O=b.next();!O.done;O=b.next())e=O.value,N=g.Ie(e),Y=N.entityId,VLI(a.V,Y)||k.push(e);return g.n(K,hTU(a,k),2)}P=K.V;return g.n(K,MLJ(a,P),0)})};
X6.prototype.retry=function(){var q=this;return g.h(function(a){return g.n(a,S8e(q),0)})};HaV.prototype.lM=function(q,a){a=a===void 0?!0:a;var w=this,G,k,b,O,e,N,Y,P;return g.h(function(K){switch(K.U){case 1:if(!w.V)return K.return();G=[];k=g.Gg(w.V.U,a);b=[];for(O={uY:0};O.uY<k.length;O={uY:O.uY},O.uY++)e=k[O.uY],N=w.V.ea(e,"json3"),Y=g.JG(N,{withCredentials:!0,format:"RAW"},3,500).then(function(d){return function(T){T={metadata:g.XY(k[d.uY]),trackData:T.xhr.responseText};b.push(T)}}(O)).AK(function(d){Ga("Caption fetch error",d)}),G.push(Y);
return g.n(K,Wcy(G),2);case 2:return g.ml(K,3),g.n(K,J$K(q,b),5);case 5:g.xl(K,0);break;case 3:P=g.rc(K),Ga("Caption DB transaction error",P),g.Jm(K)}})};g.Z(jq,g.c);jq.prototype.qB=function(){this.U&&this.U();g.c.prototype.qB.call(this)};
jq.prototype.W=function(q){var a=this,w,G,k,b,O,e,N,Y;return g.h(function(P){G=(w=q.transfer)!=null?w:new Set;k=[];b=g.V(G);for(O=b.next();!O.done;O=b.next())e=O.value,N=g.Ie(e),Y=N.entityId,k.push(Y);return k.length===0?P.return():g.n(P,UGB(a,k),0)})};g.Z(uNJ,g.c);g.C=uNJ.prototype;g.C.qB=function(){this.y7&&this.y7();this.jt.dispose();this.Y.dispose();this.L7&&g.D3(this.L.GR,this.L7);this.EK&&g.D3(this.L.GR,this.EK);g.c.prototype.qB.call(this)};
g.C.SBT=function(q){var a=this,w,G,k;return g.h(function(b){switch(b.U){case 1:w=g.uH(q,"transfer");if(a.V&&w===a.V.key){UW(a.X,a.D,!0);a.Y.stop();b.Gl(0);break}return g.n(b,Wu(a.U,{mode:"readwrite",EA:!0},function(O){return oi(O,w,"transfer").then(function(e){if(e&&e.transferState!=="TRANSFER_STATE_COMPLETE"&&e.transferState!=="TRANSFER_STATE_FAILED")return e.transferState="TRANSFER_STATE_PAUSED_BY_USER",tJ(O,e,"transfer").then(function(){return e})})}),3);
case 3:G=b.V;if(!G){b.Gl(0);break}if(!q||!a.W){b.Gl(5);break}return g.n(b,Ta(q,a.W,a.U,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.n(b,uC(a,q),7);case 7:k=b.V,RCK({videoId:q,C3:G,offlineModeType:k}),g.Jm(b)}})};
g.C.Cwt=function(){var q=this;if(this.V&&this.D){UW(this.X,this.D,!1);var a=this.V,w=(a==null?0:a.key)?g.Ie(a.key).entityId:"";w&&this.W&&(new Promise(function(G,k){Ta(w,q.W,q.U,"DOWNLOAD_STATE_PAUSED").catch(function(b){k(b)})})).catch(function(G){Ga("Download state setting error",G)})}this.Y.stop()};
g.C.Bg=function(){this.V?zTx(this,this.V):Iy(this)};
g.C.IU=function(q){var a=this;return g.h(function(w){switch(w.U){case 1:if(!a.V){w.Gl(2);break}if(a.V.transferState==="TRANSFER_STATE_COMPLETE"||a.V.transferState==="TRANSFER_STATE_FAILED"||!q.transfer||!q.transfer.has(a.V.key)){w.Gl(3);break}return g.n(w,Ri(a.U,a.V.key,"transfer"),4);case 4:a.V=w.V;if(a.V){w.Gl(3);break}return g.n(w,iay(a),3);case 3:if(a.V)return w.return();case 2:return g.n(w,Iy(a),0)}})};
g.C.kt=function(q,a){var w=this,G,k,b,O,e;return g.h(function(N){switch(N.U){case 1:if(!w.V){tC(w,"onTransferFailure: "+q);N.Gl(2);break}G=w.V;b=((k=G)==null?0:k.key)?g.Ie(G.key).entityId:"";a:switch(q){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var Y=!1;break a;default:Y=!0}return Y&&Gec(w)?g.n(N,vM(w,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.n(N,
keV(w,q),5);case 5:if(!b||!w.W){N.Gl(2);break}return g.n(N,Ta(b,w.W,w.U,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.n(N,uC(w,b),9);case 9:O=N.V;eq({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:b,C3:G,offlineModeType:O});if(!b||!w.W){N.Gl(2);break}return g.n(N,Ta(b,w.W,w.U,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:oy(w),e=Iy(w,!0),a&&a(e),g.Jm(N)}})};
g.C.Y8=function(q){var a=this,w,G,k,b,O,e,N,Y,P,K,d,T;return g.h(function(F){switch(F.U){case 1:if(!a.V){tC(a,"onMaybeTransferStreamsExpired");F.Gl(2);break}return Gec(a)?g.n(F,vM(a,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.n(F,keV(a,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!a.W){F.Gl(2);break}w=a.V;k=((G=w)==null?0:G.key)?g.Ie(w.key).entityId:"";if(!k){F.Gl(2);break}return g.n(F,Ta(k,a.W,a.U,"DOWNLOAD_STATE_FAILED"),2);case 9:return a.V||tC(a,"onMaybeTransferStreamsExpiredRetryAttempting"),
b=a.V,e=((O=b)==null?0:O.key)?g.Ie(b.key).entityId:"",g.n(F,uC(a,e),10);case 10:return N=F.V,eq({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:e,C3:b,offlineModeType:N}),Y=GEc(),g.rI(Y,HM,{isEnqueuedForExpiredStreamUrlRefetch:!0}),P=g.uH(e,"playbackData"),K={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:P,actionMetadata:Y},d=EW(new Cq("playbackData",e,K)),g.n(F,Dr(a.U,d,"offlineOrchestrationActionWrapperEntity"),2);case 2:oy(a),T=Iy(a,!0),
q&&q(T),g.Jm(F)}})};
var euc={},b_B=(euc.TRANSFER_STATE_TRANSFERRING=1,euc.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,euc);g.C=za.prototype;g.C.VW=function(){return this.D.promise};
g.C.H6=function(){if(this.U&&this.X)return this.D.promise;eH8(this).then(this.D.resolve).catch(this.D.reject);return this.D.promise};
g.C.GP=function(q){var a={};return a.playbackData=new IHl(q,this.V7,this.V),a.transfer=new eT8(q,this.V7),a.videoPlaybackPositionEntity=new Dbx(q,this.V7),a};
g.C.MP=function(){var q=this;return g.h(function(a){return q.U?g.n(a,tLV(q.U),0):a.Gl(0)})};
g.C.v6=function(){var q=this,a,w;return g.h(function(G){if(G.U==1)return q.U||q.X?g.n(G,q.VW(),2):G.return();q.S!==void 0&&(g.Pr(q.S),q.S=void 0);q.Y!==void 0&&(g.Pr(q.Y),q.Y=void 0);(a=q.U)==null||a.dispose();q.U=void 0;(w=q.X)==null||w.dispose();q.X=void 0;q.api.zl("onOrchestrationLostLeader");q.D=new g.Y8;g.Jm(G)})};
g.C.isOrchestrationLeader=function(){return this.W.V};
g.C.CA=function(){return g.h(function(q){return q.return(!1)})};
g.C.Al=function(q){var a=this.V;a.api.publish("offlinetransferpause",q);var w;(w=a.U)==null||w.postMessage(q)};
g.C.Bg=function(q){var a,w;return g.h(function(G){if(G.U==1)return g.n(G,qB(),2);a=G.V;if(!a)return G.return();w=g.uH(q,"transfer");return g.n(G,Wu(a,{mode:"readwrite",EA:!0},function(k){var b=oi(k,w,"transfer"),O=oi(k,g.uH(q,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.$7.all([b,O]).then(function(e){e=g.V(e);var N=e.next().value;var Y=e.next().value;return N&&N.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(N.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",tJ(k,N,"transfer").then(function(){eq({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:q,C3:N,offlineModeType:Y==null?void 0:Y.offlineModeType});return g.$7.resolve(null)})):g.$7.resolve(null)})}),0)})};
g.C.yR=function(q){q=q===void 0?43200:q;var a=this,w,G,k,b,O,e,N,Y;return g.h(function(P){if(P.U==1)return a.L.GA()?g.n(P,qB(),2):P.return(N0U());if(P.U!=3){w=P.V;if(!w)return P.return([]);G=Date.now()/1E3;return g.n(P,yU(w,"offlineVideoPolicy"),3)}k=P.V;b=[];O=g.V(k);for(e=O.next();!e.done;e=O.next())N=e.value,Number(N.lastUpdatedTimestampSeconds)+q<=G&&(Y=g.Ie(N.key).entityId,b.push(Y));return b.length?P.return(iC(a,b,a.J,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):P.return([])})};
g.C.deleteAll=function(){return iC(this,["!*$_ALL_ENTITIES_!*$"],this.J,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.C.refreshAllStaleEntities=function(q){var a=this;return g.h(function(w){return w.U==1?g.n(w,a.yR(q),2):w.return(w.V)})};
g.C.setUpPositionSyncInterval=function(q){var a=this;this.Y!==void 0&&(g.Pr(this.Y),this.Y=void 0);var w=q!=null?q:864E5;this.Y=g.NL(function(){a.Dz(w)},w)};
g.C.Dz=function(q){var a=this,w,G,k,b,O,e;return g.h(function(N){switch(N.U){case 1:return g.ml(N,2),g.n(N,UG.getInstance(),4);case 4:w=N.V;if(!w)throw Error("prefStorage is undefined");return g.n(N,w.get("psi"),5);case 5:G=N.V;b=((k=G)==null?0:k.HG)?Number(G.HG)/1E3:0;O=Date.now();if(!(b+q<=O)){N.Gl(6);break}return g.n(N,iC(a,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.xl(N,0);break;case 2:e=g.rc(N),Ga("Offline manager error",e),
g.Jm(N)}})};
g.C.Eu=function(){var q=this,a,w,G,k,b,O,e;return g.h(function(N){if(N.U==1)return g.n(N,qB(),2);if(N.U!=3)return(a=N.V)?g.n(N,yU(a,"transfer"),3):N.return([]);w=N.V;G=[];k=g.V(w);for(b=k.next();!b.done;b=k.next())O=b.value,O.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&O.key&&(e=g.Ie(O.key).entityId,G.push(e));return N.return(PxU(q,G))})};
g.C.Dq=function(){return g.h(function(q){return q.return([])})};
g.C.N0=function(){return g.h(function(q){g.Jm(q)})};
g.C.KN=function(){return g.h(function(q){g.Jm(q)})};g.Z(Kje,hC);Kje.prototype.U=function(q){return Y2(q)?$X7(this,q):PM(q)?Fjx(this,q):Kq(q)?CxI(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};
var WM=[10];g.Z(mXJ,hC);mXJ.prototype.U=function(q){return Y2(q)?xXB(this,q):PM(q)?LjK(this,q):Kq(q)?B0x(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};
var AKy=[10];g.Z(ng8,hC);ng8.prototype.U=function(q){return PM(q)?hHU(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};g.Z(SLx,za);g.C=SLx.prototype;g.C.GP=function(q){var a=za.prototype.GP.call(this,q);a.mainVideoEntity=new mXJ(q,this.V7,this.V);a.mainPlaylistEntity=new Kje(q,this.V7,this.V);a.mainDownloadsListEntity=new ng8(q,this.V7,this.V);return a};
g.C.refreshAllStaleEntities=function(q,a){var w=this,G,k,b,O,e,N,Y,P,K,d,T;return g.h(function(F){switch(F.U){case 1:G=[];if(!w.V7.T("web_player_offline_playlist_auto_refresh")){F.Gl(2);break}return g.n(F,feJ(w,q,a),3);case 3:G=F.V;case 2:return g.n(F,UG.getInstance(),4);case 4:return k=F.V,g.n(F,(b=k)==null?void 0:b.get("sdois"),5);case 5:return O=F.V,g.n(F,(e=k)==null?void 0:e.get("lmqf"),6);case 6:N=F.V;if(!O){F.Gl(7);break}P=G;K=P.concat;return g.n(F,H_K(w,O,(Y=N)!=null?Y:"SD",q===0),8);case 8:G=
K.call(P,F.V);case 7:return d=G,T=d.concat,g.n(F,za.prototype.refreshAllStaleEntities.call(w,q,a),9);case 9:return G=T.call(d,F.V),F.return(G)}})};
g.C.CA=function(q){var a,w,G,k,b,O,e,N;return g.h(function(Y){if(Y.U==1)return g.n(Y,qB(),2);if(Y.U!=3)return(a=Y.V)?g.n(Y,Ri(a,g.H_,"mainDownloadsListEntity"),3):Y.return(!1);w=Y.V;if((G=w)==null?0:(k=G.downloads)==null?0:k.length)for(b=g.uH(q,"mainVideoEntity"),O=g.V(w.downloads),e=O.next();!e.done;e=O.next())if(N=e.value,N.videoItem===b)return Y.return(!0);return Y.return(!1)})};
g.C.Dq=function(){var q=this,a,w,G,k,b,O,e,N;return g.h(function(Y){if(Y.U==1)return g.n(Y,qB(),2);if(Y.U!=3)return(a=Y.V)?g.n(Y,yU(a,"downloadStatusEntity"),3):Y.return([]);w=Y.V;G=[];k=g.V(w);for(b=k.next();!b.done;b=k.next())O=b.value,O.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&O.key&&(e=g.Ie(O.key).entityId,G.push(e));return G.length?(N={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},Y.return(iC(q,G,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
N))):Y.return([])})};
g.C.KN=function(){var q;return g.h(function(a){return a.U==1?g.n(a,qB(),2):(q=a.V)?g.n(a,Wu(q,{mode:"readwrite",EA:!0},function(w){return Ii(w,"mainVideoEntity").then(function(G){var k=[];G=g.V(G);for(var b=G.next();!b.done;b=G.next()){b=b.value;var O=void 0;(O=b.userState)!=null&&O.playbackPosition||(O=g.Ie(b.key).entityId,O={key:g.uH(O,"videoPlaybackPositionEntity"),videoId:O,lastPlaybackPositionSeconds:"0"},k.push(tJ(w,O,"videoPlaybackPositionEntity")),b.userState={playbackPosition:O.key},k.push(tJ(w,
b,"mainVideoEntity")))}return g.$7.all(k)})}),0):a.return()})};
g.C.N0=function(){var q,a,w,G,k,b,O,e,N,Y,P,K,d,T,F,J,Q,B,L,M,H,X,D,z,Oj,$l,ey,Nm,a_,BJ,WJ,gy,F8,eK,Mm,O7,cR,uV;return g.h(function(lb){if(lb.U==1)return g.n(lb,qB(),2);if(lb.U!=3){q=lb.V;if(!q)return lb.return();a=g.uH("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.n(lb,Wu(q,{mode:"readonly",EA:!0},function(r){return g.$7.all([oi(r,a,"mainDownloadsListEntity"),oi(r,g.H_,"mainDownloadsListEntity"),Ii(r,"mainVideoEntity"),Ii(r,"mainPlaylistEntity")])}),3)}w=lb.V;
G=g.V(w);k=G.next().value;b=G.next().value;O=G.next().value;e=G.next().value;N=k;Y=b;P=O;K=e;d=new Set;if((T=N)==null?0:(F=T.downloads)==null?0:F.length)for(J=g.V(N.downloads),Q=J.next();!Q.done;Q=J.next())B=Q.value,L=void 0,(M=(L=B.videoItem)!=null?L:B.playlistItem)&&d.add(M);if((H=Y)==null?0:(X=H.downloads)==null?0:X.length)for(D=g.V(Y.downloads),z=D.next();!z.done;z=D.next())Oj=z.value,Oj.videoItem&&d.add(Oj.videoItem);$l=new Set;ey=[];Nm=g.V(K);for(a_=Nm.next();!a_.done;a_=Nm.next()){BJ=a_.value;
if(BJ.videos)for(WJ=g.V(BJ.videos),gy=WJ.next();!gy.done;gy=WJ.next())F8=gy.value,(eK=JSON.parse(g.Ie(F8).entityId).videoId)&&$l.add(eK);BJ.key&&!d.has(BJ.key)&&ey.push(BJ.key)}Mm=g.V(P);for(O7=Mm.next();!O7.done;O7=Mm.next())cR=O7.value,cR.key&&!d.has(cR.key)&&(uV=g.Ie(cR.key).entityId,$l.has(uV)||ey.push(cR.key));return ey.length?g.n(lb,s1y(q,ey),0):lb.Gl(0)})};g.Z(cKI,hC);cKI.prototype.U=function(q){return Y2(q)?UXR(this,q):PM(q)?XnB(this,q):Kq(q)?jIx(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};
var Ry=[10];g.Z(Ie6,hC);Ie6.prototype.U=function(q){return Y2(q)?tu7(this,q):PM(q)?vg6(this,q):Kq(q)?zHl(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};
var y3=[10];g.Z(DXc,hC);DXc.prototype.U=function(q){return Y2(q)?gnR(this,q):PM(q)?aSI(this,q):Kq(q)?wrU(this,q):Promise.reject(Error("Unsupported action type: "+q.actionType))};
var qFe=[10];g.Z(qa,za);qa.prototype.GP=function(q){var a=za.prototype.GP.call(this,q);a.musicTrack=new DXc(q,this.V);a.musicPlaylist=new Ie6(q,this.V);a.musicAlbumRelease=new cKI(q,this.V);return a};
qa.prototype.refreshAllStaleEntities=function(q,a){var w=this,G,k,b;return g.h(function(O){if(O.U==1)return g.n(O,kny(w,q,a),2);if(O.U!=3)return k=G=O.V,b=k.concat,g.n(O,za.prototype.refreshAllStaleEntities.call(w,q,a),3);G=b.call(k,O.V);return O.return(G)})};g.Z(byR,g.md);g.C=byR.prototype;g.C.create=function(){var q=this;g.p(this,this.events);if(g.Zg(this.V7))this.V=new SLx(this.V7,this.player);else if(g.BA(this.V7)||g.VG(this.V7))this.V=new qa(this.V7,this.player);this.events.C(this.player,"onPlaybackStartExternal",function(){q.lW()});
this.events.C(this.player,"videodatachange",function(){q.lW()});
this.V7.T("html5_offline_playback_position_sync")&&this.events.C(this.player,"presentingplayerstatechange",this.Ey)};
g.C.AZ=function(){return!1};
g.C.Wx=function(q,a,w,G){var k=this;return g.h(function(b){return k.V?b.return(iC(k.V,q,a,w,G)):b.return(Promise.reject())})};
g.C.deleteAll=function(){return this.V.deleteAll()};
g.C.yR=function(q){return this.V.yR(q)};
g.C.refreshAllStaleEntities=function(q){return this.V.refreshAllStaleEntities(q)};
g.C.setUpPositionSyncInterval=function(q){this.V.setUpPositionSyncInterval(q)};
g.C.Al=function(q){this.V.Al(q)};
g.C.Bg=function(q){return this.V.Bg(q)};
g.C.lW=function(){var q=this,a;return g.h(function(w){a=q.player.getVideoData();return g.T4(a)?OyR(a)&&q.U!==a.clientPlaybackNonce?g.n(w,lSl(q,a),0):w.Gl(0):w.return()})};
g.C.Ey=function(q){var a=this,w,G,k,b,O,e,N;return g.h(function(Y){if(Y.U==1)return w=a.player.getVideoData(),G=w.RA,g.Ox(q,2)||g.Ox(q,512)?g.n(Y,qB(),2):Y.return();if(Y.U!=3){k=Y.V;if(!k)return Ga("PES is undefined"),Y.return();b=w.videoId;return g.n(Y,Ri(k,g.uH(b,"mainVideoEntity"),"mainVideoEntity"),3)}O=Y.V;if(!O)return Y.return();e=Math.floor(G).toString();N={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:e}};return g.n(Y,a.Wx([b],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
N),0)})};
g.C.isOrchestrationLeader=function(){return this.V.isOrchestrationLeader()};
g.C.updateDownloadState=function(q,a){var w,G,k,b;return g.h(function(O){if(O.U==1)return g.n(O,qB(),2);w=O.V;if(!w)return Ga("PES is undefined"),O.return();G=g.Ie(q);k=G.entityType;b=G.entityId;return g.n(O,Ta(b,k,w,a,!0),0)})};g.Jq("offline",byR);})(_yt_player);
